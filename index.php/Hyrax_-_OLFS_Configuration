
<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<title>Hyrax - OLFS Configuration - OPeNDAP Documentation</title>
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Hyrax_-_OLFS_Configuration skin-monobook action-view">
<div id="globalWrapper">
<div id="column-content"><div id="content" class="mw-body-primary" role="main">
	
	
	<h1 id="firstHeading" class="firstHeading" lang="en"><span dir="auto">Hyrax - OLFS Configuration</span></h1>
	<div id="bodyContent" class="mw-body">
		<div id="siteSub">From OPeNDAP Documentation</div>
		<div id="contentSub"></div>
		

		<!-- start content -->
<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Overview"><span class="tocnumber">1</span> <span class="toctext">Overview</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#OLFS_Configuration_Location"><span class="tocnumber">2</span> <span class="toctext">OLFS Configuration Location</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Retired"><span class="tocnumber">2.1</span> <span class="toctext">Retired</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#OLFS_Files"><span class="tocnumber">3</span> <span class="toctext">OLFS Files</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Hyrax_Servlet_Configuration"><span class="tocnumber">4</span> <span class="toctext">Hyrax Servlet Configuration</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Dispatch_Handlers"><span class="tocnumber">4.1</span> <span class="toctext">Dispatch Handlers</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#olfs.xml_Configuration_File"><span class="tocnumber">4.2</span> <span class="toctext"><b>olfs.xml</b> Configuration File</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#OLFSConfig_element"><span class="tocnumber">4.3</span> <span class="toctext">OLFSConfig element</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#.3CBESManager.3E_element_.28required.29"><span class="tocnumber">4.4</span> <span class="toctext"><b>&lt;BESManager&gt;</b> element (required)</span></a>
<ul>
<li class="toclevel-3 tocsection-10"><a href="#.3CBES.3E_element_.28required.29"><span class="tocnumber">4.4.1</span> <span class="toctext"><b>&lt;BES&gt;</b> element (required)</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="#.3Cprefix.3E_element_.28required.29"><span class="tocnumber">4.4.2</span> <span class="toctext"><b>&lt;prefix&gt;</b> element (required)</span></a></li>
<li class="toclevel-3 tocsection-12"><a href="#.3Chost.3E_element_.28required.29"><span class="tocnumber">4.4.3</span> <span class="toctext"><b>&lt;host&gt;</b> element (required)</span></a></li>
<li class="toclevel-3 tocsection-13"><a href="#.3Cport.3E_element_.28required.29"><span class="tocnumber">4.4.4</span> <span class="toctext"><b>&lt;port&gt;</b> element (required)</span></a></li>
<li class="toclevel-3 tocsection-14"><a href="#.3CtimeOut.3E_element_.28optional.29"><span class="tocnumber">4.4.5</span> <span class="toctext"><b>&lt;timeOut&gt;</b> element (optional)</span></a></li>
<li class="toclevel-3 tocsection-15"><a href="#.3CmaxResponseSize.3E_element_.28optional.29"><span class="tocnumber">4.4.6</span> <span class="toctext"><b>&lt;maxResponseSize&gt;</b> element (optional)</span></a></li>
<li class="toclevel-3 tocsection-16"><a href="#.3CClientPool.3E_element_.28optional.29"><span class="tocnumber">4.4.7</span> <span class="toctext"><b>&lt;ClientPool&gt;</b> element (optional)</span></a></li>
<li class="toclevel-3 tocsection-17"><a href="#.3CadminPort.3E_element_.28optional.29"><span class="tocnumber">4.4.8</span> <span class="toctext"><b>&lt;adminPort&gt;</b> element (optional)</span></a></li>
<li class="toclevel-3 tocsection-18"><a href="#Example_BESManager_configuration_element"><span class="tocnumber">4.4.9</span> <span class="toctext">Example BESManager configuration element</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-19"><a href="#.3CCatalogCache.3E_element"><span class="tocnumber">4.5</span> <span class="toctext"><b>&lt;CatalogCache&gt;</b> element</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#.3CDispatchHandlers.3E_element"><span class="tocnumber">4.6</span> <span class="toctext"><b>&lt;DispatchHandlers&gt;</b> element</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#.3CHttpGetHandlers.3E_element"><span class="tocnumber">4.7</span> <span class="toctext"><b>&lt;HttpGetHandlers&gt;</b> element</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#.3CHttpPostHandlers.3E_element"><span class="tocnumber">4.8</span> <span class="toctext"><b>&lt;HttpPostHandlers&gt;</b> element</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="#.3CHandler.3E_elements"><span class="tocnumber">4.9</span> <span class="toctext"><b>&lt;Handler&gt;</b> elements</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="#HTTP_GET_Handlers"><span class="tocnumber">4.10</span> <span class="toctext">HTTP GET Handlers</span></a></li>
<li class="toclevel-2 tocsection-25"><a href="#VersionDispatchHandler_.28required.29"><span class="tocnumber">4.11</span> <span class="toctext">VersionDispatchHandler (required)</span></a>
<ul>
<li class="toclevel-3 tocsection-26"><a href="#Example_Configuration_Element"><span class="tocnumber">4.11.1</span> <span class="toctext">Example Configuration Element</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-27"><a href="#BotBlocker_.28optional.29"><span class="tocnumber">4.12</span> <span class="toctext">BotBlocker (optional)</span></a>
<ul>
<li class="toclevel-3 tocsection-28"><a href="#.3CIpAddress.3E_element"><span class="tocnumber">4.12.1</span> <span class="toctext"><b>&lt;IpAddress&gt;</b> element</span></a></li>
<li class="toclevel-3 tocsection-29"><a href="#.3C_IpMatch_.3E_element"><span class="tocnumber">4.12.2</span> <span class="toctext"><b>&lt; IpMatch &gt;</b> element</span></a></li>
<li class="toclevel-3 tocsection-30"><a href="#Example_Configuration_Element_2"><span class="tocnumber">4.12.3</span> <span class="toctext">Example Configuration Element</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-31"><a href="#Ncml_Dataset_Dispatcher_.28required.29"><span class="tocnumber">4.13</span> <span class="toctext">Ncml Dataset Dispatcher (required)</span></a>
<ul>
<li class="toclevel-3 tocsection-32"><a href="#Example_Configuration_Element_3"><span class="tocnumber">4.13.1</span> <span class="toctext">Example Configuration Element</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-33"><a href="#Static_Thredds_Catalog_Dispatch_Handler_.28required.29"><span class="tocnumber">4.14</span> <span class="toctext">Static Thredds Catalog Dispatch Handler (required)</span></a>
<ul>
<li class="toclevel-3 tocsection-34"><a href="#.3Cprefix.3E_element_.28required.29_2"><span class="tocnumber">4.14.1</span> <span class="toctext"><b>&lt;prefix&gt;</b> element (required)</span></a></li>
<li class="toclevel-3 tocsection-35"><a href="#.3CuseMemoryCache.3E_element_.28optional.29"><span class="tocnumber">4.14.2</span> <span class="toctext"><b>&lt;useMemoryCache&gt;</b> element (optional)</span></a></li>
<li class="toclevel-3 tocsection-36"><a href="#.3CingestTransformFile.3E_element_.28optional.29"><span class="tocnumber">4.14.3</span> <span class="toctext"><b>&lt;ingestTransformFile&gt;</b> element (optional)</span></a></li>
<li class="toclevel-3 tocsection-37"><a href="#Example_Configuration_Element_4"><span class="tocnumber">4.14.4</span> <span class="toctext">Example Configuration Element</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-38"><a href="#Gateway_Dispatcher"><span class="tocnumber">4.15</span> <span class="toctext">Gateway Dispatcher</span></a>
<ul>
<li class="toclevel-3 tocsection-39"><a href="#.3Cprefix.3E_element_.28required.29_3"><span class="tocnumber">4.15.1</span> <span class="toctext"><b>&lt;prefix&gt;</b> element (required)</span></a></li>
<li class="toclevel-3 tocsection-40"><a href="#Example_Configuration_Element_5"><span class="tocnumber">4.15.2</span> <span class="toctext">Example Configuration Element</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-41"><a href="#DapDispatchHandler_.28required.29"><span class="tocnumber">4.16</span> <span class="toctext">DapDispatchHandler (required)</span></a>
<ul>
<li class="toclevel-3 tocsection-42"><a href="#.3CAllowDirectDataSourceAccess.3E_element_.28optional.29"><span class="tocnumber">4.16.1</span> <span class="toctext"><b>&lt;AllowDirectDataSourceAccess&gt;</b> element (optional)</span></a></li>
<li class="toclevel-3 tocsection-43"><a href="#.3CUseDAP2ResourceUrlResponse.3E_element_.28optional.29"><span class="tocnumber">4.16.2</span> <span class="toctext"><b>&lt;UseDAP2ResourceUrlResponse&gt;</b> element (optional)</span></a></li>
<li class="toclevel-3 tocsection-44"><a href="#Example_Configuration_Element_6"><span class="tocnumber">4.16.3</span> <span class="toctext">Example Configuration Element</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-45"><a href="#DirectoryDispatchHandler_.28required.29"><span class="tocnumber">4.17</span> <span class="toctext">DirectoryDispatchHandler (required)</span></a>
<ul>
<li class="toclevel-3 tocsection-46"><a href="#Example_Configuration_Element_7"><span class="tocnumber">4.17.1</span> <span class="toctext">Example Configuration Element</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-47"><a href="#BES_Thredds_Dispatch_Handler_.28required.29"><span class="tocnumber">4.18</span> <span class="toctext">BES Thredds Dispatch Handler (required)</span></a>
<ul>
<li class="toclevel-3 tocsection-48"><a href="#Example_Configuration_Element_8"><span class="tocnumber">4.18.1</span> <span class="toctext">Example Configuration Element</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-49"><a href="#File_Dispatch_Handler_.28required.29"><span class="tocnumber">4.19</span> <span class="toctext">File Dispatch Handler (required)</span></a>
<ul>
<li class="toclevel-3 tocsection-50"><a href="#Example_Configuration_Element_9"><span class="tocnumber">4.19.1</span> <span class="toctext">Example Configuration Element</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-51"><a href="#HTTP_POST_Handlers"><span class="tocnumber">4.20</span> <span class="toctext">HTTP POST Handlers</span></a></li>
<li class="toclevel-2 tocsection-52"><a href="#Example_olfs.xml_file"><span class="tocnumber">4.21</span> <span class="toctext">Example olfs.xml file</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-53"><a href="#THREDDS_configuration_catalog.xml_file"><span class="tocnumber">5</span> <span class="toctext">THREDDS configuration <b>catalog.xml</b> file</span></a></li>
<li class="toclevel-1 tocsection-54"><a href="#Logging_configuration_.28logback.xml_file.29"><span class="tocnumber">6</span> <span class="toctext">Logging configuration (<b>logback.xml</b> file)</span></a></li>
<li class="toclevel-1 tocsection-55"><a href="#web.xml_configuration_file"><span class="tocnumber">7</span> <span class="toctext"><b>web.xml</b> configuration file</span></a>
<ul>
<li class="toclevel-2 tocsection-56"><a href="#Servlet_Definition"><span class="tocnumber">7.1</span> <span class="toctext">Servlet Definition</span></a></li>
<li class="toclevel-2 tocsection-57"><a href="#.3Cinit-param.3E_Elements"><span class="tocnumber">7.2</span> <span class="toctext">&lt;init-param&gt; Elements</span></a>
<ul>
<li class="toclevel-3 tocsection-58"><a href="#OLFSConfigFileName"><span class="tocnumber">7.2.1</span> <span class="toctext">OLFSConfigFileName</span></a></li>
<li class="toclevel-3 tocsection-59"><a href="#DebugOn"><span class="tocnumber">7.2.2</span> <span class="toctext">DebugOn</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-60"><a href="#Example_of_web.xml_content"><span class="tocnumber">7.3</span> <span class="toctext">Example of web.xml content</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-61"><a href="#Viewers_Servlet_.28viewers.xml_file.29"><span class="tocnumber">8</span> <span class="toctext">Viewers Servlet (<b>viewers.xml</b> file)</span></a>
<ul>
<li class="toclevel-2 tocsection-62"><a href="#viewers.xml_configuration_file"><span class="tocnumber">8.1</span> <span class="toctext"><b>viewers.xml</b> configuration file</span></a>
<ul>
<li class="toclevel-3 tocsection-63"><a href="#.3CJwsHandler.3E_elements"><span class="tocnumber">8.1.1</span> <span class="toctext"><b>&lt;JwsHandler&gt;</b> elements</span></a></li>
<li class="toclevel-3 tocsection-64"><a href="#.3CWebServiceHandler.3E_elements"><span class="tocnumber">8.1.2</span> <span class="toctext"><b>&lt;WebServiceHandler&gt;</b> elements</span></a></li>
<li class="toclevel-3 tocsection-65"><a href="#Example_Configuration"><span class="tocnumber">8.1.3</span> <span class="toctext">Example Configuration</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-66"><a href="#Docs_Servlet"><span class="tocnumber">9</span> <span class="toctext">Docs Servlet</span></a></li>
<li class="toclevel-1 tocsection-67"><a href="#Logging"><span class="tocnumber">10</span> <span class="toctext">Logging</span></a></li>
<li class="toclevel-1 tocsection-68"><a href="#Authentication_.26_Authorization"><span class="tocnumber">11</span> <span class="toctext">Authentication &amp; Authorization</span></a>
<ul>
<li class="toclevel-2 tocsection-69"><a href="#Apache_Web_Server_.28httpd.29"><span class="tocnumber">11.1</span> <span class="toctext">Apache Web Server (httpd)</span></a></li>
<li class="toclevel-2 tocsection-70"><a href="#Tomcat"><span class="tocnumber">11.2</span> <span class="toctext">Tomcat</span></a></li>
<li class="toclevel-2 tocsection-71"><a href="#Limitations"><span class="tocnumber">11.3</span> <span class="toctext">Limitations</span></a></li>
<li class="toclevel-2 tocsection-72"><a href="#Persistence"><span class="tocnumber">11.4</span> <span class="toctext">Persistence</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-73"><a href="#Compressed_Responses_and_Tomcat"><span class="tocnumber">12</span> <span class="toctext">Compressed Responses and Tomcat</span></a>
<ul>
<li class="toclevel-2 tocsection-74"><a href="#Details"><span class="tocnumber">12.1</span> <span class="toctext">Details</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="Overview"><span class="mw-headline-number">1</span> Overview</span></h2>
<p>This document should help you get started configuring the OLFS web application component of Hyrax. This software package was developed, compiled, and tested using the java 1.6.x compiler, the 1.6.x Java Virtual Machine, and Jakarta Tomcat 7.x.x (which also provided the javax.servlet packages).
</p><p>The OLFS web application is composed of these servlets:
</p>
<ul>
<li> <b>Hyrax servlet</b> - The Hyrax servlet provides DAP (and other) services for the Hyrax server. The Hyrax servlet does the majority of the work in the OLFS web application. It does this by providing a flexible "dispatch" mechanism through which incoming requests are evaluated by a series of DispatchHandlers (pieces of software) that can choose to handle the request, or ignore it. The OLFS ships with a standard set of DispathHandlers which handle requests for  OPeNDAP data products, THREDDS catalogs, and OPeNDAP directories. These defalut DispatchHandlers can be augmented by adding custom handlers without the need to recompile the software. All of the DispatchHandlers used by the Hyrax servlet are identified in the <b>olfs.xml</b> configuration file.
</li>
<li> <b>Viewers servlet</b> - The Viewers servlet provides a service for datasets through which Web Services and Java WebStart applications that might be used with the dataset are identified. The Viewers servlet is configured via the <b>viewers.xml</b> file.
</li>
<li> <b>Docs servlet</b> - The Docs servlet provides clients access to a tree of static documents. By default a minimal set of documents are provided (containing information about Hyrax), these can be replaced by user supplied documents and images. By changing the images and documents available through the Docs servlet the data provider can further customize the appearance and layout of the Hyrax server web pages  to better conform with their parent organizations visual identity. The Docs servlet has no specific configuration file.
</li>
<li> <a href="../index.php/Hyrax_-_Administrators_Interface" title="Hyrax - Administrators Interface"> <b>Admin Interface servlet</b></a> - The Hyrax Administration Interface (HAI) provides server administrators with a GUI for monitoring, controlling, and configuring the server. <a href="../index.php/Hyrax_-_Administrators_Interface" title="Hyrax - Administrators Interface"> The Admin Interface is documented here.</a>
</li>
<li> <a href="../index.php/BES_-_Modules_-_Gateway_Module" title="BES - Modules - Gateway Module"> <b>Gateway servlet</b></a> - Provides a gateway service that allows Hyrax to be configured to retrieve files (that the server recognizes as data)  from the web and then provide DAP services for those files once they are retrieved. The Gateway servlet does not require additional configuration, only that the BES be correctly configured to perform gateway tasks. <a href="../index.php/BES_-_Modules_-_Gateway_Module" title="BES - Modules - Gateway Module"> The BES Gateway Module is documented here.</a>
</li>
</ul>
<p>Additionally the OLFS web application relies on one or more instances of the <a rel="nofollow" class="external text" href="../index.php/Hyrax_-_BES_Configuration">BES</a> to provide it with data access and basic catalog metadata.
</p><p>The OLFS web application stores it's configuration state in a number of files. The server's configuration is altered by carefully modifying the content of one or more of these files and then restarting the web application (or simply restarting Tomcat).
</p><p>The remainder of this document is concerned with how to correctly configure the Hyrax and Viewers servlets - the primary components of the OLFS web application.
</p>
<h2><span class="mw-headline" id="OLFS_Configuration_Location"><span class="mw-headline-number">2</span> OLFS Configuration Location</span></h2>
<dl>
<dt> Configuration Location
</dt>
</dl>
<p>Beginning with olfs-1.15.0 (part of hyrax-1.13.0) the OLFS will use the following procedure to locating it's configuration:
</p>
<ol>
<li> It will first look at the value of the user environment variable <tt>OLFS_CONFIG_DIR</tt>. If the variable is set and it's value is the path name of an existing directory that is readable by Tomcat, it is used. Otherwise,
</li>
<li> If the directory <tt>/etc/olfs</tt> exists and is readable it will use that. Otherwise,
</li>
<li> It will utilize the default configuration bundled with in the web application web archive file (opendap.war).
</li>
</ol>
<p>In this way the OLFS can start without a persistent local configuration. If the default configuration works for your intended use then there is no need create a persistent localized configuration. If changes need to be made to the configuration then it is <b>strongly recommended</b> that the user enable the use of a persistent local configuration. This way updating the web application won't destroy your changes. This is easily done by creating an empty directory and identifying it with the <tt>OLFS_CONFIG_DIR</tt> environment variable. For example:
</p>
<pre>export OLFS_CONFIG_DIR="/home/tomcat/hyrax"
</pre>
<p>Alternatively, you can create the directory <tt>/etc/olfs</tt>, and ensure that it is both readable and writeable by Tomcat.
</p><p>Once the directory is created (and in the former case the environment variable is set) restart the OLFS (Tomcat) this will cause the OLFS to move a copy of it's default configuration into the empty directory and then utilize it. You can then edit the local copy.
</p>
<h3><span class="mw-headline" id="Retired"><span class="mw-headline-number">2.1</span> Retired</span></h3>
<p>In olfs-1.14.1 (part of hyrax-1.12.2) and earlier the OLFS web application was located in the 'persistent content directory': <i>$CATALINA_HOME/content/opendap</i>. This caused bootstrap problems when the OLFS tried to set itself up on a Linux system in which the Tomcat installation had been done via RPM.
</p>
<h2><span class="mw-headline" id="OLFS_Files"><span class="mw-headline-number">3</span> OLFS Files</span></h2>
<p>The OLFS web application gets its configuration from 4 files. In general all of your configuration need will be met by making changes to the first two: <b>olfs.xml</b> and <b>catalog.xml</b>
</p>
<dl>
<dd>
</dd>
</dl>
<dl>
<dt><b>olfs.xml</b> 
</dt>
<dd><i><b>role:</b></i> Contains the localized OLFS configuration - location of the BES(s), directory view instructions, etc. 
</dd>
<dd><i><b>location:</b></i> In the persistent content directory which by default is located at <i>$CATALINA_HOME/content/opendap/</i>
</dd>
</dl>
<dl>
<dt><b>catalog.xml</b> 
</dt>
<dd><i><b>role:</b></i> Master(top-level) THREDDS catalog content for static THREDDS catalogs. 
</dd>
<dd><i><b>location:</b></i>  In the persistent content directory which by default is located at <i>$CATALINA_HOME/content/opendap/</i>
</dd>
</dl>
<dl>
<dt><b>viewers.xml</b> 
</dt>
<dd><i><b>role:</b></i> Contains the localized Viewers configuration. 
</dd>
<dd><i><b>location:</b></i> In the persistent content directory which by default is located at <i>$CATALINA_HOME/content/opendap/</i>
</dd>
</dl>
<dl>
<dt><b>web.xml</b>
</dt>
<dd><i><b>role:</b></i> Core servlet configuration. 
</dd>
<dd><i><b>location:</b></i> The servlet's web.xml file located in the WEB-INF directory of the web application "opendap". Typically that means <i>$CATALINA_HOME/webapps/opendap/WEB-INF/web.xml </i>
</dd>
</dl>
<dl>
<dt><b>log4j.xml</b>
</dt>
<dd><i><b>role:</b></i> Contains the logging configuration for Hyrax.
</dd>
<dd><i><b>location:</b></i> The default location for the <i>log4j.xml</i> is in the WEB-INF directory of the web application "opendap". Typically that means <i>$CATALINA_HOME/webapps/opendap/WEB-INF/log4j.xml</i>  However, Hyrax can be configured to look in additional places for the <i>log4j.xml</i> file. <a href="../index.php/Hyrax_-_Logging_Configuration" title="Hyrax - Logging Configuration"> Read More About It Here</a>.
</dd>
</dl>
<h2><span class="mw-headline" id="Hyrax_Servlet_Configuration"><span class="mw-headline-number">4</span> Hyrax Servlet Configuration</span></h2>
<p>The Hyrax servlet is the front end (public interface) for <a href="../index.php/Hyrax" title="Hyrax">Hyrax</a>. It provides DAP services, THREDDS catalogs, directory views, logging, and authentication services.  This is accomplished through a collection of software components called DispatchHandlers. At startup the Hyrax servlet reads the <b>olfs.xml</b> file which contains a list of DispatchHandlers and their configurations. DispatchHandlers on the list are loaded, configured/initialized, and then used to provide the aforementioned services.
</p>
<h3><span class="mw-headline" id="Dispatch_Handlers"><span class="mw-headline-number">4.1</span> Dispatch Handlers</span></h3>
<p>Request dispatch is the process in through which the OLFS determines what actual piece of code is going to respond to a given incoming request. This version of the OLFS handles each incoming request by offering the request to a series of DispatchHandlers. Each DispatchHandler is asked if it can handle the request. The first DispatchHandler to say that it can handle the request is then asked to do so. The OLFS creates an ordered list of DispatchHandlers objects in memory by reading the <b>olfs.xml</b>. 
</p><p>The order of the list is significant. There is no guarantee that two (or more) DispatchHandlers may claim a particular request. Since the first DispatchHandler in the list to claim a request gets to service it, changing the order of the DispatchHandlers can change the behaviour of the OLFS (and thus of Hyrax). For example the URL: 
</p>
<pre><a rel="nofollow" class="external free" href="http://localhost:8080/opendap/data/">http://localhost:8080/opendap/data/</a> 
</pre>
<p>Is recognized by both the <i>DirectoryDispatchHandler</i> and the <i>ThreddsDispatchHandler</i>  as a request for a directory view: both can provide a such a view. However, only the  <i>DirectoryDispatchHandler</i> can be configured to not claim the request and pass it on for another handler (in this case the <i>ThreddsDispatchHandler</i>) to pickup. The result is that if you put the <i>ThreddsDispatchHandler</i> prior to the <i>DirectoryDispatchHandler</i> on the list there will be no possible way to get OPeNDAP directory view - the  <i>ThreddsDispatchHandler</i> will claim them all.
</p><p>The usefulness of this dispatching scheme is that it creates extensibility. If a third party wishes to add new functionality to Hyrax one way is to write a DispatchHandler. To incorporate it into Hyrax they only need to add it to the list in the <b>olfs.xml</b> and add the java classes to the Tomcat lib directory.
</p>
<h3><span class="mw-headline" id="olfs.xml_Configuration_File"><span class="mw-headline-number">4.2</span> <b>olfs.xml</b> Configuration File</span></h3>
<p>The <b>olfs.xml</b> file contains the core configuration of the Hyrax servlet:
</p>
<ul>
<li> Configures the BESManager with at least one BES to be used by the OLFS web application
</li>
<li> Identifies all of the DispatchHandlers to be used by the Hyrax servlet.
</li>
<li> Controls both view and access behaviours of the Hyrax servlet.
</li>
</ul>
<h3><span class="mw-headline" id="OLFSConfig_element"><span class="mw-headline-number">4.3</span> OLFSConfig element</span></h3>
<p>The &lt;<i>OLFSConfig</i>&gt; element is the document root and it contains two elements that suppy the configuration for the OLFS: &lt;<i>BesManager</i>&gt; and &lt;<i>DispatchHandlers</i> &gt;
</p>
<h3><span class="mw-headline" id=".3CBESManager.3E_element_.28required.29"><span class="mw-headline-number">4.4</span> <b>&lt;BESManager&gt;</b> element (required)</span></h3>
<p>The BESManager element provides configuration for the BESManager class. The BESManager is used various parts of the OLFS web application whenever the software needs to access BES(s) services. This configuration  is key to the function of Hyrax. In it each BES that is connected to a Hyrax installation is defined. The following examples will show a single BES example. <b><a href="../index.php/Hyrax_-_Configuring_The_OLFS_To_Work_With_Multiple_BES%27s" title="Hyrax - Configuring The OLFS To Work With Multiple BES's">For more information on configuring Hyrax to use multiple BES's look here.</a></b>
</p><p>Each BES is identified using a seperate &lt;<i>BES</i>&gt; child element inside of the &lt;<i>BESManager</i>&gt; element.
</p>
<h4><span class="mw-headline" id=".3CBES.3E_element_.28required.29"><span class="mw-headline-number">4.4.1</span> <b>&lt;BES&gt;</b> element (required)</span></h4>
<p>The &lt;<i>BES</i>&gt; element provides the OLFS with connection and control information for a BES. There are 4 child elements in a &lt;<i>BES</i>&gt; element: &lt;<i>prefix</i>&gt;, &lt;<i>host</i>&gt;, &lt;<i>port</i>&gt;, and &lt;<i>ClientPool</i>&gt;
</p>
<h4><span class="mw-headline" id=".3Cprefix.3E_element_.28required.29"><span class="mw-headline-number">4.4.2</span> <b>&lt;prefix&gt;</b> element (required)</span></h4>
<p>This child element of the &lt;<i>BES</i>&gt; element contains the URL prefix that the OLFS will associate with this BES. This provides a mapping bewteen this BES to the URI space serviced by the OLFS. Essentailly what this means is that the prefix is a token that is placed between the <i>host:port/context/</i> part of the Hyrax URL and the catalog root used to designate a particular BES instance in the case that multiple BES's are available to a single OLFS.  For a single BES (the default configuration)  the tag MUST be designated by "/". The prefix is used to provide a mapping for each BES connected to the OLFS to URI space serviced by the OLFS. 
</p>
<ol>
<li> There <b>must</b> one (but only one) BES element in the BESManager handler configuration whose prefix has a value of "/" (see <i>example 1</i>). There may be more than one &lt;<i>BES</i>&gt; but there must be at least that one.
</li>
<li> For a single BES (the one with "/" as it's prefix) no additional effort is required. However, when using multiple BES's it is neccesary that each BES have a mount point exposed as a directory (aka collection) in URI space where it's going to appear. See <a href="../index.php/Hyrax_-_Configuring_The_OLFS_To_Work_With_Multiple_BES%27s" title="Hyrax - Configuring The OLFS To Work With Multiple BES's">Configuring With Multiple BES's</a> for more information.
</li>
<li> The prefix string <b>must</b> always begin with the slash ("/") character. (see <i>example 2</i>)
</li>
</ol>
<p><i>example 1:</i> 
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1"> <span class="sc3"><span class="re1">&lt;prefix<span class="re2">&gt;</span></span></span>/<span class="sc3"><span class="re1">&lt;/prefix<span class="re2">&gt;</span></span></span></pre></div></div>
<p><i>example 2:</i>
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1"> <span class="sc3"><span class="re1">&lt;prefix<span class="re2">&gt;</span></span></span>/data/nc<span class="sc3"><span class="re1">&lt;/prefix<span class="re2">&gt;</span></span></span></pre></div></div>
<h4><span class="mw-headline" id=".3Chost.3E_element_.28required.29"><span class="mw-headline-number">4.4.3</span> <b>&lt;host&gt;</b> element (required)</span></h4>
<p>This child element of the &lt;<i>BES</i>&gt; element contains the host name or IP address of the BES.
</p><p><i>example:</i> 
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1"><span class="sc3"><span class="re1">&lt;host<span class="re2">&gt;</span></span></span>test.opendap.org<span class="sc3"><span class="re1">&lt;/host</span> <span class="re2">&gt;</span></span></pre></div></div>
<h4><span class="mw-headline" id=".3Cport.3E_element_.28required.29"><span class="mw-headline-number">4.4.4</span> <b>&lt;port&gt;</b> element (required)</span></h4>
<p>This child element of the &lt;<i>BES</i>&gt; element contains port number on which the BES is listening.
</p><p><i>example:</i> 
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1"><span class="sc3"><span class="re1">&lt;port<span class="re2">&gt;</span></span></span>10022<span class="sc3"><span class="re1">&lt;/port</span> <span class="re2">&gt;</span></span></pre></div></div>
<h4><span class="mw-headline" id=".3CtimeOut.3E_element_.28optional.29"><span class="mw-headline-number">4.4.5</span> <b>&lt;timeOut&gt;</b> element (optional)</span></h4>
<p>This child element of the &lt;<i>BES</i>&gt; element contains the timeout time, in seconds, for the OLFS to wait for this BESto respond. Defaults to 300 seconds.
</p><p><i>example:</i> 
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1"><span class="sc3"><span class="re1">&lt;timeOut<span class="re2">&gt;</span></span></span>600<span class="sc3"><span class="re1">&lt;/timeOut</span> <span class="re2">&gt;</span></span></pre></div></div>
<h4><span class="mw-headline" id=".3CmaxResponseSize.3E_element_.28optional.29"><span class="mw-headline-number">4.4.6</span> <b>&lt;maxResponseSize&gt;</b> element (optional)</span></h4>
<p>This child element of the &lt;<i>BES</i>&gt; element contains the maximum response size, in bytes, allowed for this BES. Requests that produce a larger response will receive an error response.  A value of zero, <i>0</i>, indicates that there is no imposed limit. The default value is 0.
</p><p><i>example:</i> 
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1"><span class="sc3"><span class="re1">&lt;maxResponseSize<span class="re2">&gt;</span></span></span>0<span class="sc3"><span class="re1">&lt;/maxResponseSize<span class="re2">&gt;</span></span></span></pre></div></div>
<h4><span class="mw-headline" id=".3CClientPool.3E_element_.28optional.29"><span class="mw-headline-number">4.4.7</span> <b>&lt;ClientPool&gt;</b> element (optional)</span></h4>
<p>This child element of the &lt;<i>BES</i>&gt; element configures the behavior of the pool of client connections that the OLFS maintains with this particular BES. These connections are pooled for efficiency and speed. Currently the only configuration item available is to control the maximum number of concurrent BES client connections that the OLFS may make, the default is 200, but the size should be optimized for your locale by empirical testing. The size of the Client Pool is controlled by the <i>maximum</i> attribute. The default value of <i>maximum</i> is 200.
</p><p><i>example:</i> 
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1"><span class="sc3"><span class="re1">&lt;ClientPool</span> <span class="re0">maximum</span>=<span class="st0">&quot;17&quot;</span> <span class="re2">/&gt;</span></span></pre></div></div>
<p>If the &lt;ClientPool&gt; element is missing the pool size defaults to 200.
</p>
<h4><span class="mw-headline" id=".3CadminPort.3E_element_.28optional.29"><span class="mw-headline-number">4.4.8</span> <b>&lt;adminPort&gt;</b> element (optional)</span></h4>
<p>This child element of the &lt;<i>BES</i>&gt; element contains the port on the BES system that can be used by the Hyrax Admin Interface to control the BES. THe BES must also be configured to open and utilize this admin port.
</p><p><i>example:</i> 
</p>
 <div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1"><span class="sc3"><span class="re1">&lt;adminPort<span class="re2">&gt;</span></span></span>11002<span class="sc3"><span class="re1">&lt;/adminPort<span class="re2">&gt;</span></span></span></pre></div></div>
<h4><span class="mw-headline" id="Example_BESManager_configuration_element"><span class="mw-headline-number">4.4.9</span> Example BESManager configuration element</span></h4>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1"><span class="sc3"><span class="re1">&lt;BESManager<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;BES<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;prefix<span class="re2">&gt;</span></span></span>/<span class="sc3"><span class="re1">&lt;/prefix<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;host<span class="re2">&gt;</span></span></span>localhost<span class="sc3"><span class="re1">&lt;/host<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;port<span class="re2">&gt;</span></span></span>10022<span class="sc3"><span class="re1">&lt;/port<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;timeOut<span class="re2">&gt;</span></span></span>300<span class="sc3"><span class="re1">&lt;/timeOut<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;maxResponseSize<span class="re2">&gt;</span></span></span>0<span class="sc3"><span class="re1">&lt;/maxResponseSize<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;ClientPool</span> <span class="re0">maximum</span>=<span class="st0">&quot;10&quot;</span> <span class="re0">maxCmds</span>=<span class="st0">&quot;2000&quot;</span> <span class="re2">/&gt;</span></span>
        <span class="sc3"><span class="re1">&lt;adminPort<span class="re2">&gt;</span></span></span>11002<span class="sc3"><span class="re1">&lt;/adminPort<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;/BES<span class="re2">&gt;</span></span></span>
<span class="sc3"><span class="re1">&lt;/BESManager</span> <span class="re2">&gt;</span></span></pre></div></div>
<h3><span class="mw-headline" id=".3CCatalogCache.3E_element"><span class="mw-headline-number">4.5</span> <b>&lt;CatalogCache&gt;</b> element</span></h3>
<p>The catalog cache element configures the OLFS memory cache of BES catalog responses. This cache can greatly increase server performance for small requests. It is configured by it's two child elements, <tt>maxEntries</tt> and <tt>updateIntervalSeconds</tt>. 
</p>
<ul>
<li> The value of  <tt>maxEntries</tt>  determines the total number of catalog responses to hold in memory. The default value for  <tt>maxEntries</tt> is 10000. 
</li>
<li> The value of <tt>updateIntervalSeconds</tt> determines how long the catalog update thread will sleep between updates. This value affects the servers responsiveness to changes in it's holdings. If your servers contents change frequently, then the <tt>updateIntervalSeconds</tt>  should be set to a value that will allow the server to publish new additions/deletions in a timely manner. The <tt>updateIntervalSeconds</tt> default value 10000 seconds (2.7 hours). 
</li>
<li> If for some reason you which to disable the <tt>CatalogCache</tt>, simply remove (or comment out) the <tt>CatalogCache</tt> element and it's children from the <tt>olfs.xml</tt> file.
</li>
</ul>
<h3><span class="mw-headline" id=".3CDispatchHandlers.3E_element"><span class="mw-headline-number">4.6</span> <b>&lt;DispatchHandlers&gt;</b> element</span></h3>
<p>The &lt;<i>DispatchHandlers</i>&gt; element has two child elements: &lt;<i>HttpGetHandlers</i>&gt; and &lt;<i>HttpPostHandlers</i>&gt;. The &lt;<i>HttpGetHandlers</i>&gt; contains and ordered list of the DispatchHandler classes used by the OLFS to handle incoming HTTP GET requests.
</p>
<h3><span class="mw-headline" id=".3CHttpGetHandlers.3E_element"><span class="mw-headline-number">4.7</span> <b>&lt;HttpGetHandlers&gt;</b> element</span></h3>
<p>The &lt;<i>HttpGetHandlers</i>&gt; contains and ordered list of the DispatchHandler classes used by the OLFS to handle incoming HTTP GET requests.  The list order is significant, and permutating the order will (probably negatively) change the behavior of the OLFS. Each DispatchHandler on the list will be asked to handle the request. The first DispatchHandler on the list to claim the request will be asked to build the response.
</p>
<h3><span class="mw-headline" id=".3CHttpPostHandlers.3E_element"><span class="mw-headline-number">4.8</span> <b>&lt;HttpPostHandlers&gt;</b> element</span></h3>
<p>While programmatic support for POST request handlers is part of the Hyrax servlet there are currently no HttpPostHandlers implemented for use with Hyrax. Maybe down the road…
</p>
<h3><span class="mw-headline" id=".3CHandler.3E_elements"><span class="mw-headline-number">4.9</span> <b>&lt;Handler&gt;</b> elements</span></h3>
<p>Both the  &lt;<i>HttpGetHandlers</i>&gt; and &lt;<i>HttpPostHandlers</i>&gt; contain an orderd list of &lt;<i>Handler</i>&gt; elements. Each &lt;<i>Handler</i>&gt; must have an attribute call <i>className</i> whose value is set to the fully qualified Java class name for the DispatchHandler implementation to be used. For example:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1">  <span class="sc3"><span class="re1">&lt;Handler</span> <span class="re0">className</span>=<span class="st0">&quot;opendap.bes.VersionDispatchHandler&quot;</span> <span class="re2">/&gt;</span></span></pre></div></div>
<p>Names the class <i>opendap.bes.VersionDispatchHandler</i>.
</p><p>Each &lt;<i>Handler</i>&gt; element may contain a collection of child elements that provide configuration information to the DispatchHandler implementation. In this example:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1">  <span class="sc3"><span class="re1">&lt;Handler</span> <span class="re0">className</span>=<span class="st0">&quot;opendap.coreServlet.BotBlocker&quot;</span><span class="re2">&gt;</span></span>
      <span class="sc3"><span class="re1">&lt;IpAddress</span>&amp;<span class="re2">&gt;</span></span>44.55.66.77<span class="sc3"><span class="re1">&lt;/IpAddress<span class="re2">&gt;</span></span></span>
  <span class="sc3"><span class="re1">&lt;/Handler<span class="re2">&gt;</span></span></span></pre></div></div>
<p>The &lt;<i>Handler</i>&gt; element contains a child element &lt;<i>IpAddress</i>&gt; that indicates  to the <i>BotBlocker</i> class to block requests from the IP address 44.55.66.77.
</p>
<h3><span class="mw-headline" id="HTTP_GET_Handlers"><span class="mw-headline-number">4.10</span> HTTP GET Handlers</span></h3>
<p>Hyrax uses the following DispatchHandlers to handle HTTP GET requests:
</p>
<dl>
<dt> VersionDispatchHandler</dt>
<dd> Handles the version document requests.
</dd>
<dt> BotBlocker</dt>
<dd> This optional handler may be used to block access to your server individual IP addressesl or groups of IP addresses.
</dd>
<dt> NcmlDatasetDispatcher</dt>
<dd>
</dd>
<dt> StaticCatalogDispatch</dt>
<dd> Provides static THREDDS catalog services for Hyrax.
</dd>
<dt> Gateway</dt>
<dd> 
</dd>
<dt> DapDispatcher</dt>
<dd> Handles all DAP requests.
</dd>
<dt> DirectoryDispatchHandler</dt>
<dd> Handles the OPeNDAP directory view (contents.html)  requests.
</dd>
<dt> BESThreddsDispatchHandler</dt>
<dd> Provides dynamic THREDDS catalogs of all BES holdings.
</dd>
<dt> FileDispatchHandlerr</dt>
<dd> Handles requests for file level access. (README files etc.)
</dd>
</dl>
<p><br />
</p>
<h3><span class="mw-headline" id="VersionDispatchHandler_.28required.29"><span class="mw-headline-number">4.11</span> VersionDispatchHandler (required)</span></h3>
<p>Handles the version document requests. This DispatchHandler has no configuration elements, so it will always be written like this:
</p>
<h4><span class="mw-headline" id="Example_Configuration_Element"><span class="mw-headline-number">4.11.1</span> Example Configuration Element</span></h4>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1"><span class="sc3"><span class="re1">&lt;Handler</span> <span class="re0">className</span>=<span class="st0">&quot;opendap.bes.VersionDispatchHandler&quot;</span> <span class="re2">/&gt;</span></span></pre></div></div>
<h3><span class="mw-headline" id="BotBlocker_.28optional.29"><span class="mw-headline-number">4.12</span> BotBlocker (optional)</span></h3>
<p>This optional handler can be used to block access from specific IP addresses and by a ranges of IP addresses using regular expressions. It turns out that many of the web crawling robots do not respect the robots.txt file when one is provided. Since many sites do not want their data holdings exhaustively queried by automated software, we created a simple robot blocking handler to protect system resources from non-compliant robots.
</p>
<h4><span class="mw-headline" id=".3CIpAddress.3E_element"><span class="mw-headline-number">4.12.1</span> <b>&lt;IpAddress&gt;</b> element</span></h4>
<p>The text value of this element should be the IP address of a system which you would like to block from accessing your service. For example:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1">    <span class="sc3"><span class="re1">&lt;IpAddress<span class="re2">&gt;</span></span></span>128.193.64.33<span class="sc3"><span class="re1">&lt;/IPAddress<span class="re2">&gt;</span></span></span></pre></div></div>
<p>Blocks the system located at 128.193.64.33 from accessing your server. There can be zero or more &lt;IpAddress&gt; elements in the &lt;BotBlocker&gt;
</p>
<h4><span class="mw-headline" id=".3C_IpMatch_.3E_element"><span class="mw-headline-number">4.12.2</span> <b>&lt; IpMatch &gt;</b> element</span></h4>
<p>The text value of this element should be the regular expression that will be used to match the IP addresses clients attempting to access Hyrax.
</p><p>For example:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1">    <span class="sc3"><span class="re1">&lt;IpMatch<span class="re2">&gt;</span></span></span>65\.55\.[012]?\d?\d\.[012]?\d?\d<span class="sc3"><span class="re1">&lt;/IpMatch<span class="re2">&gt;</span></span></span></pre></div></div>
<p>Matches all IP address beginning with 65.55 and thus block access for clients whose IP addresses lie in that range. There can be zero or more &lt; IpMatch &gt; elements in the Handler configuration for teh BotBlocker
</p>
<h4><span class="mw-headline" id="Example_Configuration_Element_2"><span class="mw-headline-number">4.12.3</span> Example Configuration Element</span></h4>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1">    <span class="sc3"><span class="re1">&lt;Handler</span> <span class="re0">className</span>=<span class="st0">&quot;opendap.coreServlet.BotBlocker&quot;</span><span class="re2">&gt;</span></span>
&#160;
        <span class="sc3"><span class="re1">&lt;IpAddress<span class="re2">&gt;</span></span></span>127.0.0.1<span class="sc3"><span class="re1">&lt;/IpAddress<span class="re2">&gt;</span></span></span>
&#160;
        <span class="sc-1">&lt;!-- This matches all IPv4 addresses, work yours out from here.... --&gt;</span>
        <span class="sc-1">&lt;!--&lt;IpMatch&gt;[012]?\d?\d\.[012]?\d?\d\.[012]?\d?\d\.[012]?\d?\d&lt;/IpMatch&gt; --&gt;</span>
&#160;
        <span class="sc-1">&lt;!-- Any IP starting with 65.55 (MSN bots the don't respect robots.txt  --&gt;</span>
        <span class="sc3"><span class="re1">&lt;IpMatch<span class="re2">&gt;</span></span></span>65\.55\.[012]?\d?\d\.[012]?\d?\d<span class="sc3"><span class="re1">&lt;/IpMatch<span class="re2">&gt;</span></span></span>
&#160;
    <span class="sc3"><span class="re1">&lt;/Handler<span class="re2">&gt;</span></span></span></pre></div></div>
<h3><span class="mw-headline" id="Ncml_Dataset_Dispatcher_.28required.29"><span class="mw-headline-number">4.13</span> Ncml Dataset Dispatcher (required)</span></h3>
<p>The Ncml Dataset Dispatcher is a specialized handler that filters NcML content retrieved from the BES so that the path names in the NcML documents returned to clients are consistent with the paths from the external (to the server) perspective.
</p>
<h4><span class="mw-headline" id="Example_Configuration_Element_3"><span class="mw-headline-number">4.13.1</span> Example Configuration Element</span></h4>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1">            <span class="sc3"><span class="re1">&lt;Handler</span> <span class="re0">className</span>=<span class="st0">&quot;opendap.ncml.NcmlDatasetDispatcher&quot;</span> <span class="re2">/&gt;</span></span></pre></div></div>
<h3><span class="mw-headline" id="Static_Thredds_Catalog_Dispatch_Handler_.28required.29"><span class="mw-headline-number">4.14</span> Static Thredds Catalog Dispatch Handler (required)</span></h3>
<p>Serves static THREDDS catalogs (i.e. THREDDS catalog files stored on disk). Provides both a presentation view (HTML) for humans using browsers, and direct catalog access (XML). 
</p>
<h4><span class="mw-headline" id=".3Cprefix.3E_element_.28required.29_2"><span class="mw-headline-number">4.14.1</span> <b>&lt;prefix&gt;</b> element (required)</span></h4>
<p>Defines the path component that comes after the servlet context and before all catalog requests. For example, if the prefix is <i>thredds</i>, then <a rel="nofollow" class="external free" href="http://localhost:8080/opendap/thredds/">http://localhost:8080/opendap/thredds/</a> should give you the top-level static catalog (the contents of the file $CATALINA_HOME/content/opendap/catalog.xml)
</p>
<h4><span class="mw-headline" id=".3CuseMemoryCache.3E_element_.28optional.29"><span class="mw-headline-number">4.14.2</span> <b>&lt;useMemoryCache&gt;</b> element (optional)</span></h4>
<p>If the text value of this element is the string 'true' this will cause the servlet to ingest all of the static catalog files at startup and hold their contents in memory. <a href="../index.php/THREDDS_using_XSLT" title="THREDDS using XSLT">See this page for more information about the memory caching operations</a>
</p>
<h4><span class="mw-headline" id=".3CingestTransformFile.3E_element_.28optional.29"><span class="mw-headline-number">4.14.3</span> <b>&lt;ingestTransformFile&gt;</b> element (optional)</span></h4>
<p>This is a specific development option that allows one top specify the fully qualified path to an XSLT file that will be used to preprocess each THREDDS catalog file read from disk. The default version of this file (found in $CATALINA_HOME/webapps/opndap/xsl/threddsCatalogIngest.xsl) processes the <i>thredds:datasetScan</i> elements in each THREDDS catalog so that they contain specific content for Hyrax. <b>This is a developers option and in general is not recommended for use in an operational server.</b>
</p>
<h4><span class="mw-headline" id="Example_Configuration_Element_4"><span class="mw-headline-number">4.14.4</span> Example Configuration Element</span></h4>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1"><span class="sc3"><span class="re1">&lt;Handler</span> <span class="re0">className</span>=<span class="st0">&quot;opendap.threddsHandler.StaticCatalogDispatch&quot;</span><span class="re2">&gt;</span></span>
     <span class="sc3"><span class="re1">&lt;prefix<span class="re2">&gt;</span></span></span>thredds<span class="sc3"><span class="re1">&lt;/prefix<span class="re2">&gt;</span></span></span>
     <span class="sc3"><span class="re1">&lt;useMemoryCache<span class="re2">&gt;</span></span></span>true<span class="sc3"><span class="re1">&lt;/useMemoryCache<span class="re2">&gt;</span></span></span>
<span class="sc3"><span class="re1">&lt;/Handler<span class="re2">&gt;</span></span></span></pre></div></div>
<h3><span class="mw-headline" id="Gateway_Dispatcher"><span class="mw-headline-number">4.15</span> Gateway Dispatcher</span></h3>
<p>Directs requests to the <a href="../index.php/Gateway_Service" title="Gateway Service">Gateway Service</a>
</p>
<h4><span class="mw-headline" id=".3Cprefix.3E_element_.28required.29_3"><span class="mw-headline-number">4.15.1</span> <b>&lt;prefix&gt;</b> element (required)</span></h4>
<p>Defines the path component that comes after the servlet context and before all gateway requests. For example, if the prefix is <i>gateway</i>, then <a rel="nofollow" class="external free" href="http://localhost:8080/opendap/gateway/">http://localhost:8080/opendap/gateway/</a> will give you the gateway access form page.
</p>
<h4><span class="mw-headline" id="Example_Configuration_Element_5"><span class="mw-headline-number">4.15.2</span> Example Configuration Element</span></h4>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1"><span class="sc3"><span class="re1">&lt;Handler</span> <span class="re0">className</span>=<span class="st0">&quot;opendap.gateway.DispatchHandler&quot;</span><span class="re2">&gt;</span></span>
    <span class="sc3"><span class="re1">&lt;prefix<span class="re2">&gt;</span></span></span>gateway<span class="sc3"><span class="re1">&lt;/prefix<span class="re2">&gt;</span></span></span>
<span class="sc3"><span class="re1">&lt;/Handler<span class="re2">&gt;</span></span></span></pre></div></div>
<h3><span class="mw-headline" id="DapDispatchHandler_.28required.29"><span class="mw-headline-number">4.16</span> DapDispatchHandler (required)</span></h3>
<p>Handles DAP request for Hyrax. For example the DapDispatchHandler will handle requests for all DAP2 and DAP4 products
</p>
<h4><span class="mw-headline" id=".3CAllowDirectDataSourceAccess.3E_element_.28optional.29"><span class="mw-headline-number">4.16.1</span> <b>&lt;AllowDirectDataSourceAccess&gt;</b> element (optional)</span></h4>
<p>The &lt;<i>AllowDirectDataSourceAccess</i> /&gt; element controls the users ability to directly access data sources via the web interface. If this element is present (and not commented out as in the example below) a client can get an entire data source (such as an HDF file) by simply requesting it through the HTTP URL interface. This is NOT a good practice and is not recommended. By default Hyrax ships with this option turned off and I recommend that you leave it that way unless you really want users to be able to circumvent the OPeNDAP request interface and have direct access to the data products stored on your server.
</p>
<h4><span class="mw-headline" id=".3CUseDAP2ResourceUrlResponse.3E_element_.28optional.29"><span class="mw-headline-number">4.16.2</span> <b>&lt;UseDAP2ResourceUrlResponse&gt;</b> element (optional)</span></h4>
<p>By default, at least for now, the server will provide the (undefined) DAP2 style response  to requests for a dataset resource URL.
Commenting out the "UseDAP2ResourceUrlResponse" element will  cause the server to return the (well defined) DAP4 DSR response when a dataset resource URL is requested.
</p>
<h4><span class="mw-headline" id="Example_Configuration_Element_6"><span class="mw-headline-number">4.16.3</span> Example Configuration Element</span></h4>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1"><span class="sc3"><span class="re1">&lt;Handler</span> <span class="re0">className</span>=<span class="st0">&quot;opendap.bes.dapResponders.DapDispatcher&quot;</span> <span class="re2">&gt;</span></span>
    <span class="sc-1">&lt;!-- AllowDirectDataSourceAccess / --&gt;</span>
    <span class="sc3"><span class="re1">&lt;UseDAP2ResourceUrlResponse</span> <span class="re2">/&gt;</span></span>
<span class="sc3"><span class="re1">&lt;/Handler<span class="re2">&gt;</span></span></span></pre></div></div>
<h3><span class="mw-headline" id="DirectoryDispatchHandler_.28required.29"><span class="mw-headline-number">4.17</span> DirectoryDispatchHandler (required)</span></h3>
<p>Handles the OPeNDAP directory view (contents.html)  requests. 
</p>
<h4><span class="mw-headline" id="Example_Configuration_Element_7"><span class="mw-headline-number">4.17.1</span> Example Configuration Element</span></h4>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1">&#160;
<span class="sc3"><span class="re1">&lt;Handler</span> <span class="re0">className</span>=<span class="st0">&quot;opendap.bes.DirectoryDispatchHandler&quot;</span> <span class="re2">/&gt;</span></span></pre></div></div>
<h3><span class="mw-headline" id="BES_Thredds_Dispatch_Handler_.28required.29"><span class="mw-headline-number">4.18</span> BES Thredds Dispatch Handler (required)</span></h3>
<p>Provides dynamic THREDDS catalogs of BES data holdings. 
</p>
<h4><span class="mw-headline" id="Example_Configuration_Element_8"><span class="mw-headline-number">4.18.1</span> Example Configuration Element</span></h4>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1"><span class="sc3"><span class="re1">&lt;Handler</span> <span class="re0">className</span>=<span class="st0">&quot;opendap.bes.BESThreddsDispatchHandler&quot;</span> <span class="re2">/&gt;</span></span></pre></div></div>
<h3><span class="mw-headline" id="File_Dispatch_Handler_.28required.29"><span class="mw-headline-number">4.19</span> File Dispatch Handler (required)</span></h3>
<p>Handles requests for file level access. (README files etc.).  This handler only responds to requests for files that are not considered "data" by the BES. File requests for data files are handled by the <i>opendap.bes.dapResponders.DapDispatcher</i>.
</p>
<h4><span class="mw-headline" id="Example_Configuration_Element_9"><span class="mw-headline-number">4.19.1</span> Example Configuration Element</span></h4>
<p>In the following example, the FileDispatchHandler is configured to deny direct access to data sources (note that the &lt;<i>AllowDirectDataSourceAccess</i> /&gt; element is commented out:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1"><span class="sc3"><span class="re1">&lt;Handler</span> <span class="re0">className</span>=<span class="st0">&quot;opendap.bes.FileDispatchHandler&quot;</span> <span class="re2">/&gt;</span></span></pre></div></div>
<h3><span class="mw-headline" id="HTTP_POST_Handlers"><span class="mw-headline-number">4.20</span> HTTP POST Handlers</span></h3>
<p>Hyrax does not currently support HTTP POST requests.
</p><p><br />
</p>
<h3><span class="mw-headline" id="Example_olfs.xml_file"><span class="mw-headline-number">4.21</span> Example olfs.xml file</span></h3>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1"><span class="sc3"><span class="re1">&lt;?xml</span> <span class="re0">version</span>=<span class="st0">&quot;1.0&quot;</span> <span class="re0">encoding</span>=<span class="st0">&quot;UTF-8&quot;</span><span class="re2">?&gt;</span></span>
<span class="sc3"><span class="re1">&lt;OLFSConfig<span class="re2">&gt;</span></span></span>
&#160;
    <span class="sc3"><span class="re1">&lt;BESManager<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;BES<span class="re2">&gt;</span></span></span>
            <span class="sc3"><span class="re1">&lt;prefix<span class="re2">&gt;</span></span></span>/<span class="sc3"><span class="re1">&lt;/prefix<span class="re2">&gt;</span></span></span>
            <span class="sc3"><span class="re1">&lt;host<span class="re2">&gt;</span></span></span>localhost<span class="sc3"><span class="re1">&lt;/host<span class="re2">&gt;</span></span></span>
            <span class="sc3"><span class="re1">&lt;port<span class="re2">&gt;</span></span></span>10022<span class="sc3"><span class="re1">&lt;/port<span class="re2">&gt;</span></span></span>
&#160;
            <span class="sc3"><span class="re1">&lt;timeOut<span class="re2">&gt;</span></span></span>300<span class="sc3"><span class="re1">&lt;/timeOut<span class="re2">&gt;</span></span></span>
&#160;
            <span class="sc3"><span class="re1">&lt;adminPort<span class="re2">&gt;</span></span></span>11002<span class="sc3"><span class="re1">&lt;/adminPort<span class="re2">&gt;</span></span></span>
&#160;
            <span class="sc3"><span class="re1">&lt;maxResponseSize<span class="re2">&gt;</span></span></span>0<span class="sc3"><span class="re1">&lt;/maxResponseSize<span class="re2">&gt;</span></span></span>
            <span class="sc3"><span class="re1">&lt;ClientPool</span> <span class="re0">maximum</span>=<span class="st0">&quot;200&quot;</span> <span class="re0">maxCmds</span>=<span class="st0">&quot;2000&quot;</span> <span class="re2">/&gt;</span></span>
        <span class="sc3"><span class="re1">&lt;/BES<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;/BESManager<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;DispatchHandlers<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;HttpGetHandlers<span class="re2">&gt;</span></span></span>
&#160;
            <span class="sc3"><span class="re1">&lt;Handler</span> <span class="re0">className</span>=<span class="st0">&quot;opendap.bes.VersionDispatchHandler&quot;</span> <span class="re2">/&gt;</span></span>
&#160;
            <span class="sc3"><span class="re1">&lt;Handler</span> <span class="re0">className</span>=<span class="st0">&quot;opendap.coreServlet.BotBlocker&quot;</span><span class="re2">&gt;</span></span>
                <span class="sc3">&lt;<span class="re1">&lt;IpMatch<span class="re2">&gt;</span></span></span>65\.55\.[012]?\d?\d\.[012]?\d?\d<span class="sc3"><span class="re1">&lt;/IpMatch<span class="re2">&gt;</span></span></span>
            <span class="sc3"><span class="re1">&lt;/Handler<span class="re2">&gt;</span></span></span>
&#160;
&#160;
            <span class="sc3"><span class="re1">&lt;Handler</span> <span class="re0">className</span>=<span class="st0">&quot;opendap.ncml.NcmlDatasetDispatcher&quot;</span> <span class="re2">/&gt;</span></span>            
&#160;
            <span class="sc3"><span class="re1">&lt;Handler</span> <span class="re0">className</span>=<span class="st0">&quot;opendap.threddsHandler.StaticCatalogDispatch&quot;</span><span class="re2">&gt;</span></span>
                <span class="sc3"><span class="re1">&lt;prefix<span class="re2">&gt;</span></span></span>thredds<span class="sc3"><span class="re1">&lt;/prefix<span class="re2">&gt;</span></span></span>
                <span class="sc3"><span class="re1">&lt;useMemoryCache<span class="re2">&gt;</span></span></span>true<span class="sc3"><span class="re1">&lt;/useMemoryCache<span class="re2">&gt;</span></span></span>
            <span class="sc3"><span class="re1">&lt;/Handler<span class="re2">&gt;</span></span></span>
&#160;
            <span class="sc3"><span class="re1">&lt;Handler</span> <span class="re0">className</span>=<span class="st0">&quot;opendap.gateway.DispatchHandler&quot;</span><span class="re2">&gt;</span></span>
                <span class="sc3"><span class="re1">&lt;prefix<span class="re2">&gt;</span></span></span>gateway<span class="sc3"><span class="re1">&lt;/prefix<span class="re2">&gt;</span></span></span>
            <span class="sc3"><span class="re1">&lt;/Handler<span class="re2">&gt;</span></span></span>
&#160;
&#160;
&#160;
            <span class="sc3"><span class="re1">&lt;Handler</span> <span class="re0">className</span>=<span class="st0">&quot;opendap.bes.BesDapDispatcher&quot;</span> <span class="re2">&gt;</span></span>
                <span class="sc-1">&lt;!-- AllowDirectDataSourceAccess / --&gt;</span>
                <span class="sc3"><span class="re1">&lt;UseDAP2ResourceUrlResponse</span> <span class="re2">/&gt;</span></span>
            <span class="sc3"><span class="re1">&lt;/Handler<span class="re2">&gt;</span></span></span>
&#160;
            <span class="sc3"><span class="re1">&lt;Handler</span> <span class="re0">className</span>=<span class="st0">&quot;opendap.bes.DirectoryDispatchHandler&quot;</span><span class="re2">&gt;</span></span>
                <span class="sc-1">&lt;!--</span>
<span class="sc-1">                  If your particular authentication scheme (usually brokered by Apache httpd) utilizes</span>
<span class="sc-1">                  a particular logout or login location you can have Hyrax display links to those locations</span>
<span class="sc-1">                  as part of the generated web pages by uncommenting the &quot;AuthenticationControls&quot; element and</span>
<span class="sc-1">                  editing the logout and/or login locations to match your service instance.</span>
<span class="sc-1">                  --&gt;</span>
                <span class="sc-1">&lt;!-- AuthenticationControls&gt;</span>
<span class="sc-1">                    &lt;logout&gt;loginPath?login_param=foo&lt;/logout&gt;</span>
<span class="sc-1">                    &lt;logout&gt;logoutPath?logout_param=foo&lt;/logout&gt;</span>
<span class="sc-1">                &lt;/AuthenticationControls --&gt;</span>
            <span class="sc3"><span class="re1">&lt;/Handler<span class="re2">&gt;</span></span></span>
&#160;
&#160;
            <span class="sc3"><span class="re1">&lt;Handler</span> <span class="re0">className</span>=<span class="st0">&quot;opendap.bes.BESThreddsDispatchHandler&quot;</span><span class="re2">/&gt;</span></span>
            <span class="sc3"><span class="re1">&lt;Handler</span> <span class="re0">className</span>=<span class="st0">&quot;opendap.bes.FileDispatchHandler&quot;</span> <span class="re2">/&gt;</span></span>
        <span class="sc3"><span class="re1">&lt;/HttpGetHandlers<span class="re2">&gt;</span></span></span>
&#160;
&#160;
        <span class="sc-1">&lt;!--</span>
<span class="sc-1">           If you need to accept a constraint expression (ce) that is larger than will fit in a URL query string then you</span>
<span class="sc-1">           can configure the server to accept the ce as the body of a POST request referencing the same resource.</span>
<span class="sc-1">           If the the Content-Encoding of the request is set to &quot;application/x-www-form-urlencoded&quot; then the server</span>
<span class="sc-1">           will ingest all of parameter names &quot;ce&quot; and &quot;dap4:ce&quot;  to build the DAP constraint expression. Otherwise</span>
<span class="sc-1">           the server will treat the entire POST body as a DAP ce.</span>
&#160;
<span class="sc-1">           By default the maximum length of the POST body is limited to 2000000 characters, and may never be</span>
<span class="sc-1">           larger than 10000000 characters (if you need more then get in touch with support@opendap.org). You can adjust</span>
<span class="sc-1">           the limit in the configuration for the BesDapDispatcher.</span>
&#160;
<span class="sc-1">           Configuration:</span>
<span class="sc-1">           Uncomment the HttpPostHandlers element below. Make sure that the body of the BesDapDispatcher Handler element is</span>
<span class="sc-1">           IDENTICAL to it's sister in the HttpGetHandlers element above.</span>
&#160;
<span class="sc-1">           If you need to change the default value of the maximum POST body length do it by adding a</span>
<span class="sc-1">           &quot;PostBodyMaxLength&quot; element to the BesDapDispatcher Handler below:</span>
&#160;
<span class="sc-1">           &lt;PostBodyMaxLength&gt;500&lt;/PostBodyMaxLength&gt;</span>
&#160;
<span class="sc-1">           The text content of which must be an integer between 0 and 10000000</span>
<span class="sc-1">        --&gt;</span>
        <span class="sc-1">&lt;!--</span>
<span class="sc-1">        &lt;HttpPostHandlers&gt;</span>
<span class="sc-1">            &lt;Handler className=&quot;opendap.bes.dapResponders.BesDapDispatcher&quot; &gt;</span>
<span class="sc-1">                MAKE SURE THAT THE CONTENT OF THIS ELEMENT IS IDENTICAL TO IT'S SISTER IN THE  HttpGetHandlers ELEMENT!</span>
<span class="sc-1">                (Disregarding the presence of a PostBodyMaxLength element)</span>
<span class="sc-1">            &lt;/Handler&gt;</span>
<span class="sc-1">        &lt;/HttpPostHandlers&gt;</span>
<span class="sc-1">        --&gt;</span>
&#160;
&#160;
    <span class="sc3"><span class="re1">&lt;/DispatchHandlers<span class="re2">&gt;</span></span></span>
&#160;
    <span class="sc-1">&lt;!--</span>
<span class="sc-1">      This enables or disables the generation of internal timing metrics for the OLFS</span>
<span class="sc-1">      If commented out the timing is disabled. If you want timing metrics to be output</span>
<span class="sc-1">      to the log then uncomment the Timer and set the enabled attribute's value to &quot;true&quot;</span>
<span class="sc-1">      WARNING: There is some performance cost to utilizing the Timer.</span>
<span class="sc-1">    --&gt;</span>
    <span class="sc-1">&lt;!-- Timer enabled=&quot;false&quot; / --&gt;</span>
&#160;
&#160;
<span class="sc3"><span class="re1">&lt;/OLFSConfig<span class="re2">&gt;</span></span></span></pre></div></div>
<h2><span class="mw-headline" id="THREDDS_configuration_catalog.xml_file"><span class="mw-headline-number">5</span> THREDDS configuration <b>catalog.xml</b> file</span></h2>
<p>The <b>catalog.xml</b> file contains the static THREDDS catalog configuration for Hyrax. <a href="../index.php/Hyrax_-_THREDDS_Configuration" title="Hyrax - THREDDS Configuration"> Read About It Here</a>.
</p>
<h2><span class="mw-headline" id="Logging_configuration_.28logback.xml_file.29"><span class="mw-headline-number">6</span> Logging configuration (<b>logback.xml</b> file)</span></h2>
<p>The <b>logback.xml</b> file contains the logging configuration for Hyrax. <a href="../index.php/Hyrax_-_Logging_Configuration" title="Hyrax - Logging Configuration"> Read About It Here</a>.
</p>
<h2><span class="mw-headline" id="web.xml_configuration_file"><span class="mw-headline-number">7</span> <b>web.xml</b> configuration file</span></h2>
<p><i>We strongly recommend that you do <b>NOT</b> mess with the web.xml file. At least for now. Future versions of Server and the OLFS may have "user configurable" stuff in the web.xml file, but this version does not. <b>SO JUST DON'T DO IT. OK?</b></i>  Having said that, here are the details regarding the web.xml file:
</p>
<h4><span class="mw-headline" id="Servlet_Definition"><span class="mw-headline-number">7.1</span> Servlet Definition</span></h4>
<p>The OLFS running in the opendap context area needs an entry in the <b>web.xml</b> file. Multiple instances of a servlet and/or several different servlets can be configured in the one web.xml file. For instance you could have a DTS and a Hyrax running in from the same <b>web.xml</b> and thus under the same servlet context. Running multiple instances of the OLFS in a single web.xml file (aka context) will <b>NOT</b> work.
</p><p>Each a servlet needs a unique name which is specified inside a &lt;<i>servlet</i>&gt; element in the web.xml file using the &lt;<i>servlet-name</i>&gt; tag. This is a name of convenience, for example if you where serving data from an ARGOS satellite you might call that servlet <i>argos</i>.
</p><p>Additionally each instance of a &lt;<i>servlet</i>&gt; must specify which Java class contains the actual servlet to run. This is done in the &lt;<i>servlet-class</i>&gt; element. For example the OLFS servlet class name is <i>opendap.coreServlet.DispatchServlet</i>
</p><p>Here is a syntax example combining the two previous example values:
</p>
<pre>
&lt;servlet&gt;
	&lt;servlet-name&gt;hyrax&lt;/servlet-name&gt;
	&lt;servlet-class&gt;opendap.coreServlet.DispatchServlet&lt;/servlet-name&gt;
	.
	.
	.
&lt;/servlet&gt;
</pre>
<p>This servlet could then be accessed as:  <i><a rel="nofollow" class="external free" href="http://hostname/opendap/servlet/argos">http://hostname/opendap/servlet/argos</a></i>
</p><p>You may also add to the end of the web.xml file a set of &lt;<i>servlet-mapping</i>&gt; elements. These allow you to abbreviate the URL or the servlet. By placing the servlet mappings:
</p>
  <pre>
&lt;servlet-mapping&gt;
    &lt;servlet-name&gt;argos&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/argos&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;

&lt;servlet-mapping&gt;
    &lt;servlet-name&gt;argos&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/argos/*&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;
</pre>
<p>At the end of the web.xml file our previous example changes it's URL to: <i><a rel="nofollow" class="external free" href="http://hostname/opendap/argos">http://hostname/opendap/argos</a></i>
</p><p>Eliminating the need for the word servlet in the URL. For more on the &lt;<i>servlet-mapping</i>&gt; element see the Jakarta-Tomcat documentation.
</p>
<h4><span class="mw-headline" id=".3Cinit-param.3E_Elements"><span class="mw-headline-number">7.2</span> &lt;init-param&gt; Elements</span></h4>
<p>The OLFS uses &lt;init-param&gt; elements inside of each &lt;servlet&gt; element to get specific configuration information.
</p><p>&lt;init-param&gt;'s common to all OPeNDAP servlets are:
</p>
<h5><span class="mw-headline" id="OLFSConfigFileName"><span class="mw-headline-number">7.2.1</span> OLFSConfigFileName</span></h5>
<p>This parameter identifies the name of the XML document file that contains the OLFS configuration. This file must be located in the persistent content directory and is typically called <b>olfs.xml</b>
</p><p>For example:
</p>
<pre>
    &lt;init-param&gt;
	&lt;param-name&gt;OLFSConfigFileName&lt;/param-name&gt;
	&lt;param-value&gt;olfs.xml&lt;/param-value&gt;
    &lt;/init-param&gt;
</pre>
<h5><span class="mw-headline" id="DebugOn"><span class="mw-headline-number">7.2.2</span> DebugOn</span></h5>
<p>This controls output to the terminal from which the servlet engine was launched. The value is a list of flags that turn on debugging instrumentation in different parts of the code. Supported values are:
</p>
<ul>
<li><b>probeRequest</b>: Prints a lengthy inspection of the HttpServletRequest object to stdout. <i>Don't leave this on for long, it will clog your Catalina logs.</i>
</li>
<li><b>DebugInterface</b>: Enables the servers debug interface. This ineractive interface allows a user to look at (and change) the server state via a web browser. <i>Enable this only for analysis purposes, disable when finshed!</i>
</li>
</ul>
<p><i>Example</i>:
</p>
<pre>
    &lt;init-param&gt;
	&lt;param-name&gt;DebugOn&lt;/param-name&gt;
	&lt;param-value&gt;probeRequest&lt;/param-value&gt;
    &lt;/init-param&gt;
</pre>
<p><i>Default</i>: If this parameter is not set, or the value field is empty then these features will be disabled - which is what you want unless there is a problem to analyze.
</p>
<h4><span class="mw-headline" id="Example_of_web.xml_content"><span class="mw-headline-number">7.3</span> Example of web.xml content</span></h4>
<pre>
&lt;servlet&gt;

    &lt;servlet-name&gt;hyrax&lt;/servlet-name&gt;

    &lt;servlet-class&gt;opendap.coreServlet.DispatchServlet&lt;/servlet-class&gt;

    &lt;init-param&gt;
        &lt;param-name&gt;DebugOn&lt;/param-name&gt;
        &lt;param-value&gt;&lt;/param-value&gt;
    &lt;/init-param&gt;

    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;

&lt;/servlet&gt;

&lt;servlet-mapping&gt;
    &lt;servlet-name&gt;hyrax&lt;/servlet-name&gt;
    &lt;url-pattern&gt;*&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;

&lt;servlet-mapping&gt;
    &lt;servlet-name&gt;hyrax&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/hyrax&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;

&lt;servlet-mapping&gt;
    &lt;servlet-name&gt;hyrax&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/hyrax/*&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;
</pre>
<h2><span class="mw-headline" id="Viewers_Servlet_.28viewers.xml_file.29"><span class="mw-headline-number">8</span> Viewers Servlet (<b>viewers.xml</b> file)</span></h2>
<p>The Viewers servlet provides, for each dataset, and HTML page containing links to Java WebStart applications and to WebServices (such as WMS) that can be utilized in conjunction with the dataset. The Viewers servlet is configured via the contents of the <b>viewers.xml</b> file located in the persistent content directory $CATALINA_HOME/content/opendap.
</p>
<h3><span class="mw-headline" id="viewers.xml_configuration_file"><span class="mw-headline-number">8.1</span> <b>viewers.xml</b> configuration file</span></h3>
<h4><span class="mw-headline" id=".3CJwsHandler.3E_elements"><span class="mw-headline-number">8.1.1</span> <b>&lt;JwsHandler&gt;</b> elements</span></h4>
<h4><span class="mw-headline" id=".3CWebServiceHandler.3E_elements"><span class="mw-headline-number">8.1.2</span> <b>&lt;WebServiceHandler&gt;</b> elements</span></h4>
<h4><span class="mw-headline" id="Example_Configuration"><span class="mw-headline-number">8.1.3</span> Example Configuration</span></h4>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1"><span class="sc3"><span class="re1">&lt;ViewersConfig<span class="re2">&gt;</span></span></span>
&#160;
    <span class="sc3"><span class="re1">&lt;JwsHandler</span> <span class="re0">className</span>=<span class="st0">&quot;opendap.webstart.IdvViewerRequestHandler&quot;</span><span class="re2">&gt;</span></span>
        <span class="sc3"><span class="re1">&lt;JnlpFileName<span class="re2">&gt;</span></span></span>idv.jnlp<span class="sc3"><span class="re1">&lt;/JnlpFileName<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;/JwsHandler<span class="re2">&gt;</span></span></span>
&#160;
    <span class="sc3"><span class="re1">&lt;JwsHandler</span> <span class="re0">className</span>=<span class="st0">&quot;opendap.webstart.NetCdfToolsViewerRequestHandler&quot;</span><span class="re2">&gt;</span></span>
        <span class="sc3"><span class="re1">&lt;JnlpFileName<span class="re2">&gt;</span></span></span>idv.jnlp<span class="sc3"><span class="re1">&lt;/JnlpFileName<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;/JwsHandler<span class="re2">&gt;</span></span></span>
&#160;
    <span class="sc3"><span class="re1">&lt;JwsHandler</span> <span class="re0">className</span>=<span class="st0">&quot;opendap.webstart.AutoplotRequestHandler&quot;</span> <span class="re2">/&gt;</span></span>
&#160;
    <span class="sc3"><span class="re1">&lt;WebServiceHandler</span> <span class="re0">className</span>=<span class="st0">&quot;opendap.viewers.NcWmsService&quot;</span> <span class="re0">serviceId</span>=<span class="st0">&quot;ncWms&quot;</span> <span class="re2">&gt;</span></span>
        <span class="sc3"><span class="re1">&lt;applicationName<span class="re2">&gt;</span></span></span>Web Mapping Service<span class="sc3"><span class="re1">&lt;/applicationName<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;NcWmsService</span> <span class="re0">href</span>=<span class="st0">&quot;/ncWMS/wms&quot;</span> <span class="re0">base</span>=<span class="st0">&quot;/ncWMS/wms&quot;</span> <span class="re0">ncWmsDynamicServiceId</span>=<span class="st0">&quot;lds&quot;</span> <span class="re2">/&gt;</span></span>
    <span class="sc3"><span class="re1">&lt;/WebServiceHandler<span class="re2">&gt;</span></span></span>
&#160;
    <span class="sc3"><span class="re1">&lt;WebServiceHandler</span> <span class="re0">className</span>=<span class="st0">&quot;opendap.viewers.GodivaWebService&quot;</span> <span class="re0">serviceId</span>=<span class="st0">&quot;godiva&quot;</span> <span class="re2">&gt;</span></span>
        <span class="sc3"><span class="re1">&lt;applicationName<span class="re2">&gt;</span></span></span>Godiva WMS GUI<span class="sc3"><span class="re1">&lt;/applicationName<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;NcWmsService</span> <span class="re0">href</span>=<span class="st0">&quot;http://localhost:8080/ncWMS/wms&quot;</span> <span class="re0">base</span>=<span class="st0">&quot;/ncWMS/wms&quot;</span> <span class="re0">ncWmsDynamicServiceId</span>=<span class="st0">&quot;lds&quot;</span><span class="re2">/&gt;</span></span>
        <span class="sc3"><span class="re1">&lt;Godiva</span> <span class="re0">href</span>=<span class="st0">&quot;/ncWMS/godiva2.html&quot;</span> <span class="re0">base</span>=<span class="st0">&quot;/ncWMS/godiva2.html&quot;</span><span class="re2">/&gt;</span></span>
    <span class="sc3"><span class="re1">&lt;/WebServiceHandler<span class="re2">&gt;</span></span></span>
&#160;
<span class="sc3"><span class="re1">&lt;/ViewersConfig<span class="re2">&gt;</span></span></span></pre></div></div>
<h2><span class="mw-headline" id="Docs_Servlet"><span class="mw-headline-number">9</span> Docs Servlet</span></h2>
<p>The Docs (or documentation) servlet provides the OLFS web application with the ability to serve a tree of static documentation files. By default it will serve the files in the documentation tree provided with the OLFS in the Hyrax distribution. This tree is rooted at <i>$CATALINA_HOME/webapps/opendap/docs/</i> and contains documentation pertaining to the software in the Hyrax distribution - installation and configuration instruction, release notes, java docs, etc.
</p><p>If one wishes to replace this information with their own set of web pages, one can remove/replace the files in the default directory. However, installing a new version of Hyrax will cause these files to be overwritten, forcing them to be replaced after the install (and hopefully AFTER the new release documentation had been read and understood by the user).
</p><p>The Docs servlet provides an alternative to this. If a <i>docs</i> directory is created in the <i>persistent content</i> directory for Hyrax the Docs servlet will detect it (when Tomcat is launched) and it will serve files from there instead of from the default location.
</p><p>This scheme provides 2 beneficial effects:
</p>
<ol>
<li> It allows localizations of the web documents associated with Hyrax to persist through Hyrax upgrades with no user intervention.
</li>
<li> It preserves important release documents that ship with the Hyrax software.
</li>
</ol>
<p>In summary,  to provide persistent web pages as part of a Hyrax localization simple create the directory: <i>$CATALINA_HOME/content/opendap/<b>docs</b></i>
</p><p>Place your content in there and away you go. If later you wish to view the web based documentation bundled with Hyrax simply change the name of the directory from <b>docs</b> to something else and restart Tomcat. (or, you could just look in the <i>$CATALINA_HOME/webapps/opendap/docs</i> directory)
</p><p>In the Docs servlet, if a URL ends in a directory name or a "/" then the servlet will attempt to serve the <b>index.html</b> in that directory. In other words <b>index.html</b> is the default document.
</p>
<h2><span class="mw-headline" id="Logging"><span class="mw-headline-number">10</span> <a href="../index.php/Hyrax_-_Logging_Configuration" title="Hyrax - Logging Configuration"> Logging</a></span></h2>
<p><a href="../index.php/Hyrax_-_Logging_Configuration" title="Hyrax - Logging Configuration"> Logging is a big enough subject we gave it it's own page.</a>
</p>
<h2><span class="mw-headline" id="Authentication_.26_Authorization"><span class="mw-headline-number">11</span> Authentication &amp; Authorization</span></h2>
<h3><span class="mw-headline" id="Apache_Web_Server_.28httpd.29"><span class="mw-headline-number">11.1</span> Apache Web Server (httpd)</span></h3>
<p><font size="3"><b>If your organization desires secure access and authentication layers for Hyrax the recommended method is to use Hyrax in conjunction the Apache Web Server (httpd).</b></font> 
</p><p>Most organizations that utilize secure access and authentication for their web presence are already doing so via Apache Web Server and Hyrax can be integrated nicely with this existing infrastructure. 
</p><p>More about integrating Hyrax with Apache Web Server can be found at these pages:
</p>
<ul>
<li> <a href="../index.php/Hyrax_-_Apache_Integration" title="Hyrax - Apache Integration"> Integrating Hyrax with Apache Web Server. </a>
</li>
<li> <a href="../index.php/Hyrax_-_User_Identification_(Authentication)" title="Hyrax - User Identification (Authentication)"> Configuring Hyrax and Apache for User Authentication and Authorization</a>
</li>
</ul>
<h3><span class="mw-headline" id="Tomcat"><span class="mw-headline-number">11.2</span> Tomcat</span></h3>
<p>Hyrax may be used with the security features implemented by Tomcat for authentication and authorization services. 
</p><p>It is recommended that you read carefully and understand the Tomcat  security documentation.
</p><p>For Tomcat 5.x see:
</p>
<ul>
<li><a rel="nofollow" class="external text" href="http://tomcat.apache.org/tomcat-5.5-doc/index.html">Tomcat 5.x Documentation</a>
<ul>
<li><a rel="nofollow" class="external text" href="http://tomcat.apache.org/tomcat-5.5-doc/realm-howto.html">Section 6: Configuring/Managing User Realms</a>
</li>
<li><a rel="nofollow" class="external text" href="http://tomcat.apache.org/tomcat-5.5-doc/ssl-howto.html">Section 12: Configuring SSL</a>
</li>
</ul>
</li>
</ul>
<p>For Tomcat 6.x see:
</p>
<ul>
<li><a rel="nofollow" class="external text" href="http://tomcat.apache.org/tomcat-6.0-doc/index.html">Tomcat 6.x Documentation</a>
<ul>
<li><a rel="nofollow" class="external text" href="http://tomcat.apache.org/tomcat-6.0-doc/realm-howto.html">Section 6: Configuring/Managing User Realms</a>
</li>
<li><a rel="nofollow" class="external text" href="http://tomcat.apache.org/tomcat-6.0-doc/ssl-howto.html">Section 12: Configuring SSL</a>
</li>
</ul>
</li>
</ul>
<p>And that you read chapter 12 of the 
<a rel="nofollow" class="external text" href="http://jcp.org/aboutJava/communityprocess/final/jsr154/index.html">Java Servlet Specification 2.4</a>
that decribes how to configure security constraints at the web application level.
</p><p>Tomcat security requires fairly extensive additions to the <b>web.xml</b> file. (It is important to keep in mind that altering the &lt;<i>servlet</i>&gt; definitions may render your Hyrax server inoperable - please see the previous sections that discuss this.)
</p><p>Examples of security content for the web.xml file can be found in the persistent content directory of the Hyrax server, which by default is located at <i>$CATALINA_HOME/content/opendap/</i>.
</p>
<h3><span class="mw-headline" id="Limitations"><span class="mw-headline-number">11.3</span> Limitations</span></h3>
<p>Officially Tomcat security supports <i>context</i> level authentication. What this means is that you can restrict access to the collection of servlets running in a single web application - in other words all of the stuff that is defined in a single <b>web.xml</b> file. You can call out different authentication rules for different &lt;<i>url-pattern</i>&gt;'s within the web application, but only clients which do not cache ANY security information will be able to easily access the different areas. 
</p><p>For example in your <b>web.xml</b> file you might have:
<font size="2">
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1">    <span class="sc3"><span class="re1">&lt;security-constraint<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;web-resource-collection<span class="re2">&gt;</span></span></span>
            <span class="sc3"><span class="re1">&lt;web-resource-name<span class="re2">&gt;</span></span></span>fnoc1<span class="sc3"><span class="re1">&lt;/web-resource-name<span class="re2">&gt;</span></span></span>
            <span class="sc3"><span class="re1">&lt;url-pattern<span class="re2">&gt;</span></span></span>/hyrax/nc/fnoc1.txt<span class="sc3"><span class="re1">&lt;/url-pattern<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;/web-resource-collection<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;auth-constraint<span class="re2">&gt;</span></span></span>
            <span class="sc3"><span class="re1">&lt;role-name<span class="re2">&gt;</span></span></span>fn1<span class="sc3"><span class="re1">&lt;/role-name<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;/auth-constraint<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;/security-constraint<span class="re2">&gt;</span></span></span>
&#160;
    <span class="sc3"><span class="re1">&lt;security-constraint<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;web-resource-collection<span class="re2">&gt;</span></span></span>
             <span class="sc3"><span class="re1">&lt;web-resource-name<span class="re2">&gt;</span></span></span>fnoc2<span class="sc3"><span class="re1">&lt;/web-resource-name<span class="re2">&gt;</span></span></span>
             <span class="sc3"><span class="re1">&lt;url-pattern<span class="re2">&gt;</span></span></span>/hyrax/nc/fnoc2.txt<span class="sc3"><span class="re1">&lt;/url-pattern<span class="re2">&gt;</span></span></span>
         <span class="sc3"><span class="re1">&lt;/web-resource-collection<span class="re2">&gt;</span></span></span>
         <span class="sc3"><span class="re1">&lt;auth-constraint<span class="re2">&gt;</span></span></span>
             <span class="sc3"><span class="re1">&lt;role-name<span class="re2">&gt;</span></span></span>fn2<span class="sc3"><span class="re1">&lt;/role-name<span class="re2">&gt;</span></span></span>
          <span class="sc3"><span class="re1">&lt;/auth-constraint<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;/security-constraint<span class="re2">&gt;</span></span></span>
&#160;
    <span class="sc3"><span class="re1">&lt;login-config<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;auth-method<span class="re2">&gt;</span></span></span>BASIC<span class="sc3"><span class="re1">&lt;/auth-method<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;realm-name<span class="re2">&gt;</span></span></span>MyApplicationRealm<span class="sc3"><span class="re1">&lt;/realm-name<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;/login-config<span class="re2">&gt;</span></span></span></pre></div></div>
<p></font>
</p><p><br />
Where the security roles fn1 and fn2 (defined in the <b>tomcat-users.xml</b> file) have no common members.
</p><p>The complete URI's would be:
<font size="2">
</p>
<pre><a rel="nofollow" class="external free" href="http://localhost:8080/mycontext/hyrax/nc/fnoc1.txt">http://localhost:8080/mycontext/hyrax/nc/fnoc1.txt</a>
<a rel="nofollow" class="external free" href="http://localhost:8080/mycontext/hyrax/nc/fnoc2.txt">http://localhost:8080/mycontext/hyrax/nc/fnoc2.txt</a>
</pre>
<p></font>
</p><p>Now - this works, for clients that aren't too smart - i.e. they don't cache anything. However, if you access these URLs with a typical browser, once you authenticate for one URI, then you are locked out of the other one until you successfully "reset" the browser (purge all caches).
</p><p>I think the reason is as follows: In the exchange between Tomcat and the client, Tomcat is sending the header:
</p><p><font size="2"><code>WWW-Authenticate: Basic realm="MyApplicationRealm"</code></font>
</p><p>And the client authenticates. When the second URI is accessed Tomcat sends the the same authentication challenge, with the same <code>WWW-Authenticate</code> header. The client, having recently authenticated to this <i>realm-name</i> (defined in the &lt;<i>login-config</i>&gt; element in the web.xml file - see above), resends the authentication information, and, since it's not valid for that url pattern, the request is denied.
</p>
<h3><span class="mw-headline" id="Persistence"><span class="mw-headline-number">11.4</span> Persistence</span></h3>
<p>You should be careful to back up your modified <b>web.xml</b> file to a location outside of the <i>$CATALINA_HOME/webapps/opendap</i> directory as new versions of Hyrax will overwrite it when installed. You could use an <i>XML ENTITY</i> and an <i>entity reference</i> in the <b>web.xml</b> to cause a local file containing the security configuration to be included in the web.xml. For example adding the <i>ENTITY</i>:
</p><p><font size="2">
<code>    [&lt;!ENTITY securityConfig      SYSTEM "file:/fully/qualified/path/to/your/security/config.xml"&gt;]</code>
</font>
</p><p>To the &lt;<i>!DOCTYPE</i>&gt; declaration at the top of the <b>web.xml</b> in conjunction with adding an <i>entity reference</i>:
</p><p><font size="2">
<code>&amp;securityConfig;</code>
</font>
</p><p>To the content of the &lt;<i>web-app</i>&gt; element would cause your external security configuration to be included in the <b>web.xml</b> file.
</p><p>Here is an example of an <i>ENTITY</i> configuration:
</p><p><font size="2">
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1">    <span class="sc3"><span class="re1">&lt;?xml</span> <span class="re0">version</span>=<span class="st0">&quot;1.0&quot;</span> <span class="re0">encoding</span>=<span class="st0">&quot;ISO-8859-1&quot;</span><span class="re2">?&gt;</span></span>
&#160;
    <span class="sc0">&lt;!DOCTYPE web-app</span>
<span class="sc0">        PUBLIC &quot;-//Sun Microsystems, Inc.//DTD Web Application 2.2//EN&quot;</span>
<span class="sc0">        &quot;http://java.sun.com/j2ee/dtds/web-app_2_2.dtd&quot;</span>
<span class="sc0">        [&lt;!ENTITY securityConfig      SYSTEM &quot;file:/fully/qualified/path/to/your/security/config.xml&quot;&gt;</span>]
    &gt;
    <span class="sc3"><span class="re1">&lt;web-app<span class="re2">&gt;</span></span></span>
&#160;
        <span class="sc-1">&lt;!--</span>
<span class="sc-1">            Loads a persistent security configuration from the content directory.</span>
<span class="sc-1">            This configuration may be empty, in which case no security constraints will be</span>
<span class="sc-1">            applied by Tomcat.</span>
<span class="sc-1">        --&gt;</span>
        <span class="sc1">&amp;securityConfig;</span>
&#160;
        .
        .
        .
&#160;
    <span class="sc3"><span class="re1">&lt;/web-app<span class="re2">&gt;</span></span></span></pre></div></div>
<p></font>
</p><p>This will not prevent you from losing your <b>web.xml</b> file when a new version of Hyrax is installed, but adding the <i>ENTITY</i> stuff to the new <b>web.xml</b> file would be easier than remembering an extensive security configuration. Of course, Y.M.M.V.
</p>
<h2><span class="mw-headline" id="Compressed_Responses_and_Tomcat"><span class="mw-headline-number">12</span> Compressed Responses and Tomcat</span></h2>
<p>Many OPeNDAP clients accept compressed responses. This can greatly increase the efficiency of the client/server interaction by diminishing the number of bytes actually transmitted over "the wire". Tomcat provides native compression support for the GZIP compression mechanism, however it is NOT turned on by default.
</p><p>The following example is based on Tomcat 5.15. We recommend that you read carefully the Tomcat documentation related to this topic before proceeding:
</p>
<ul>
<li><a rel="nofollow" class="external text" href="http://tomcat.apache.org/">Tomcat Home</a>
</li>
<li><a rel="nofollow" class="external text" href="http://tomcat.apache.org/tomcat-5.5-doc/index.html">Tomcat 5.x documentation.</a> (See Reference Section for the Apache Tomcat Configuration section)
</li>
<li><a rel="nofollow" class="external text" href="http://tomcat.apache.org/tomcat-5.5-doc/config/http.html">Tomcat 5.x documentation section related to compression.</a>
</li>
</ul>
<h3><span class="mw-headline" id="Details"><span class="mw-headline-number">12.1</span> Details</span></h3>
<p>To enable compression you will need to edit the <i>$CATALINA_HOME/conf/server.xml</i> file. You will need to locate the &lt;<i>Connector</i>&gt; element associated with your server, typically this will be the only &lt;<i>Connector</i>&gt; element whose <i>port</i> attribute is set equal to 8080. To this you will need to add/change several attributes to enable compression.
</p><p>With my Tomcat 5.5 distribution I found this default &lt;<i>Connector</i>&gt; element definition in my <i>server.xml</i> file:
<font size="2">
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1">    <span class="sc3"><span class="re1">&lt;Connector</span> <span class="re0">port</span>=<span class="st0">&quot;8080&quot;</span> <span class="re0">maxHttpHeaderSize</span>=<span class="st0">&quot;8192&quot;</span></span>
<span class="sc3">        <span class="re0">maxThreads</span>=<span class="st0">&quot;150&quot;</span> <span class="re0">minSpareThreads</span>=<span class="st0">&quot;25&quot;</span> <span class="re0">maxSpareThreads</span>=<span class="st0">&quot;75&quot;</span>;</span>
<span class="sc3">        <span class="re0">enableLookups</span>=<span class="st0">&quot;false&quot;</span> <span class="re0">redirectPort</span>=<span class="st0">&quot;8443&quot;</span> <span class="re0">acceptCount</span>=<span class="st0">&quot;100&quot;</span></span>
<span class="sc3">        <span class="re0">connectionTimeout</span>=<span class="st0">&quot;20000&quot;</span> <span class="re0">disableUploadTimeout</span>=<span class="st0">&quot;true&quot;</span></span>
<span class="sc3">        <span class="re0">compression</span>=<span class="st0">&quot;no&quot;</span></span>
<span class="sc3">     <span class="re2">&gt;</span></span></pre></div></div>
<p></font>
You will need to add to this four attributes:
</p><p><font size="2">
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1">compression=&quot;force&quot;
compressionMinSize=&quot;2048&quot;
noCompressionUserAgents=&quot;gozilla, traviata&quot;
compressableMimeType=&quot;text/html,text/xml,application/octet-stream&quot;</pre></div></div>
<p></font>
</p><p>Notice that there is a list of compressible MIME types. Basically:
</p>
<ul>
<li> <b>compression="no"</b> means nothing gets compressed.
</li>
<li> <b>compression="yes"</b> means only the compressible MIME types get compressed.
</li>
<li> <b>compression="force"</b> means everything gets compressed (assuming the client accepts gzip and the response is bigger than compressionMinSize)
</li>
</ul>
<p>You MUST set <b>compression="force"</b> for compression to work with the OPeNDAP data transport.
</p><p>The final result being:
</p><p><font size="2">
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1">    <span class="sc3"><span class="re1">&lt;Connector</span> <span class="re0">port</span>=<span class="st0">&quot;8080&quot;</span> <span class="re0">maxHttpHeaderSize</span>=<span class="st0">&quot;8192&quot;</span></span>
<span class="sc3">        <span class="re0">maxThreads</span>=<span class="st0">&quot;150&quot;</span> <span class="re0">minSpareThreads</span>=<span class="st0">&quot;25&quot;</span> <span class="re0">maxSpareThreads</span>=<span class="st0">&quot;75&quot;</span>;</span>
<span class="sc3">        <span class="re0">enableLookups</span>=<span class="st0">&quot;false&quot;</span> <span class="re0">redirectPort</span>=<span class="st0">&quot;8443&quot;</span> <span class="re0">acceptCount</span>=<span class="st0">&quot;100&quot;</span></span>
<span class="sc3">        <span class="re0">connectionTimeout</span>=<span class="st0">&quot;20000&quot;</span> <span class="re0">disableUploadTimeout</span>=<span class="st0">&quot;true&quot;</span></span>
<span class="sc3">        <span class="re0">compression</span>=<span class="st0">&quot;no&quot;</span></span>
<span class="sc3">        <span class="re0">compression</span>=<span class="st0">&quot;force&quot;</span></span>
<span class="sc3">        <span class="re0">compressionMinSize</span>=<span class="st0">&quot;2048&quot;</span></span>
<span class="sc3">        <span class="re0">noCompressionUserAgents</span>=<span class="st0">&quot;gozilla, traviata&quot;</span></span>
<span class="sc3">        <span class="re0">compressableMimeType</span>=<span class="st0">&quot;text/html,text/xml,application/octet-stream&quot;</span></span>
<span class="sc3">     <span class="re2">&gt;</span></span></pre></div></div>
<p></font>
</p><p>Restart Tomcat for these changes to take effect.
</p><p><font size="4">
<b>NOTE: If you are using Tomcat in conjunction with the Apache Web Server (our friend httpd) via AJP you will need to <a href="../index.php/Hyrax_-_Apache_Integration#Apache_Compressed_Responses" title="Hyrax - Apache Integration"> configure Apache to deliver compressed responses</a> too. Tomcat will not compress content sent over the AJP connection.</b>
</font>
</p>



</div>
				<!-- end content -->
				<div class="visualClear"></div>
	</div>
</div></div>
</body></html>