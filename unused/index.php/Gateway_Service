
<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<title>Gateway Service - OPeNDAP Documentation</title>
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Gateway_Service skin-monobook action-view">
<div id="globalWrapper">
<div id="column-content"><div id="content" class="mw-body-primary" role="main">
	
	
	<h1 id="firstHeading" class="firstHeading" lang="en"><span dir="auto">Gateway Service</span></h1>
	<div id="bodyContent" class="mw-body">
		<div id="siteSub">From OPeNDAP Documentation</div>
		<div id="contentSub"></div>
		

		<!-- start content -->
<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Overview"><span class="tocnumber">1</span> <span class="toctext">Overview</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#BES_gateway_module"><span class="tocnumber">2</span> <span class="toctext">BES gateway_module</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#OLFS_gateway_service"><span class="tocnumber">3</span> <span class="toctext">OLFS gateway_service</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Encoding_data_source_URLs"><span class="tocnumber">4</span> <span class="toctext">Encoding data source URLs</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#Prototype_Encoding"><span class="tocnumber">4.1</span> <span class="toctext">Prototype Encoding</span></a>
<ul>
<li class="toclevel-3 tocsection-6"><a href="#Example_1"><span class="tocnumber">4.1.1</span> <span class="toctext">Example 1</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="#Example_2"><span class="tocnumber">4.1.2</span> <span class="toctext">Example 2</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#Example_3"><span class="tocnumber">4.1.3</span> <span class="toctext">Example 3</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="Overview"><span class="mw-headline-number">1</span> Overview</span></h2>
<div class="thumb tleft"><div class="thumbinner" style="width:182px;"><a href="../index.php/File:Gateway_service.jpg" class="image"><img alt="Gateway service.jpg" src="../images/thumb/8/88/Gateway_service.jpg/180px-Gateway_service.jpg" width="180" height="82" class="thumbimage" srcset="/images/thumb/8/88/Gateway_service.jpg/270px-Gateway_service.jpg 1.5x, /images/thumb/8/88/Gateway_service.jpg/360px-Gateway_service.jpg 2x" /></a>  <div class="thumbcaption"><div class="magnify"><a href="../index.php/File:Gateway_service.jpg" class="internal" title="Enlarge"><img src="../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div></div></div></div>
<p>The Gateway Service provides Hyrax with the ability to apply DAP constraint expressions and server side functions to data available through any network URL. This is accomplished by encoding the data source URL into the DAP request URL supplied to the gateway_service. The gateway_service decodes the URL and uses the BES to to retrieve the remote data resource and transmit the appropriate DAP response back to the client. The system employs a white list to control what data systems the BES will access. 
</p><p><br />
A Data Service Portal (DSP), such as Mirador will:
</p>
<ul>
<li> Provide the navigation/search/discovery interface to the data source.
</li>
<li> Generate the data source URLs.
</li>
<li> Encode the data source URLs.
</li>
<li> Build a regular DAP query as the DAP dataset ID.
</li>
<li> Hand this to the client (via a link or what have you in the DSP interface)
</li>
</ul>
<h2><span class="mw-headline" id="BES_gateway_module"><span class="mw-headline-number">2</span> BES gateway_module</span></h2>
<p>The gateway_module handles the gathering of the remote data resource and the construction of the DAP response.
</p><p>The gateway_module:
</p>
<ul>
<li> Evaluates the data source URL against a white list to access permission.
</li>
<li> Retrieves remote data source .
</li>
<li> Determines data type by:
</li>
</ul>
<ol>
<li> Direct identification via the BesXmlApi. (You tell it.)
</li>
<li> HTTP Content-Disposition header
</li>
<li> Applying the BES.TypeMatch string to the last term in the path section of the data source URL. 
</li>
</ol>
<p>The BES will <b>not</b> persist the data resources beyond the scope of each request.
</p>
<h2><span class="mw-headline" id="OLFS_gateway_service"><span class="mw-headline-number">3</span> OLFS gateway_service</span></h2>
<p>The gateway_service is responsible for:
</p>
<ul>
<li> Decoding the incoming dataset URLs.
</li>
<li> Building the request for the BES.
</li>
<li> Returning the response from the BES to the client.
</li>
</ul>
<h2><span class="mw-headline" id="Encoding_data_source_URLs"><span class="mw-headline-number">4</span> Encoding data source URLs</span></h2>
<p>The data source URLs need to be encoded in the DAP data request URL that is used to access the gateway_service.
</p><p>There are many ways to encode something in this context.
</p>
<h3><span class="mw-headline" id="Prototype_Encoding"><span class="mw-headline-number">4.1</span> Prototype Encoding</span></h3>
<p>As a prototype encoding we'll use an hex ascii encoding. In this encoding each character in the data source URL is expressed as is hexadecimal value using ascii characters.
</p><p>Here is <a rel="nofollow" class="external text" href="http://www.opendap.org/pub/gateway_service/hexEncoder.tgz">hexEncoder.tgz</a> (<a rel="nofollow" class="external text" href="http://www.opendap.org/pub/gateway_service/hexEncoder.tgz.sig">sig</a>), a gzipped tar file containing a java application can perform the encoding and decoding duties from the command line.  Give it a whirl - it's a java application in a jar file. There is a bash script (hexEncode) that should launch it. 
</p><p>The source code for the EncodeDecode java class used by hexEncode is  available here: <a rel="nofollow" class="external free" href="http://scm.opendap.org/svn/trunk/olfs/src/opendap/gateway/EncodeDecode.java">http://scm.opendap.org/svn/trunk/olfs/src/opendap/gateway/EncodeDecode.java</a>
</p><p><br />
</p>
<h4><span class="mw-headline" id="Example_1"><span class="mw-headline-number">4.1.1</span> Example 1</span></h4>
<dl>
<dt>source string</dt>
<dd> <a rel="nofollow" class="external free" href="http://www.google.com">http://www.google.com</a>
</dd>
</dl>
<dl>
<dt>stringToHex()</dt>
<dd> 687474703a2f2f7777772e676f6f676c652e636f6d
</dd>
</dl>
<dl>
<dt>hexToString(stringToHex()</dt>
<dd> <a rel="nofollow" class="external free" href="http://www.google.com">http://www.google.com</a>
</dd>
</dl>
<p><br />
</p>
<h4><span class="mw-headline" id="Example_2"><span class="mw-headline-number">4.1.2</span> Example 2</span></h4>
<dl>
<dt>Source string</dt>
<dd>      <a rel="nofollow" class="external free" href="http://g0dup05u.ecs.nasa.gov/cgi-bin/ceopAIRX2RET?service=WCS&amp;version=1.0.0&amp;request=GetCoverage&amp;coverage=H2OMMRStd&amp;crs=WGS84&amp;bbox=-107.375000,51.625000,-102.625000,56.375000&amp;format=netCDF&amp;TIME=2002-10-03&amp;resx=0.25&amp;resy=0.25&amp;interpolationMethod=Nearest%20neighbor">http://g0dup05u.ecs.nasa.gov/cgi-bin/ceopAIRX2RET?service=WCS&amp;version=1.0.0&amp;request=GetCoverage&amp;coverage=H2OMMRStd&amp;crs=WGS84&amp;bbox=-107.375000,51.625000,-102.625000,56.375000&amp;format=netCDF&amp;TIME=2002-10-03&amp;resx=0.25&amp;resy=0.25&amp;interpolationMethod=Nearest%20neighbor</a>
</dd>
</dl>
<dl>
<dt>stringToHex()</dt>
<dd>     
</dd>
</dl>
<p>687474703a2f2f67306475703035752e6563732e6e6173612e676f762f6367692d62696e2f63656f7041495258325245543f736572766963653d5743532676657273696f6e3d312e302e3026726571756573743d476574436f76657261676526636f7665726167653d48324f4d4d52537464266372733d57475338342662626f783d2d3130372e3337353030302c35312e3632353030302c2d3130322e3632353030302c35362e33373530303026666f726d61743d6e65744344462654494d453d323030322d31302d303326726573783d302e323526726573793d302e323526696e746572706f6c6174696f6e4d6574686f643d4e6561726573742532306e65696768626f72
</p>
<dl>
<dt>hexToString(stringToHex()</dt>
<dd> <a rel="nofollow" class="external free" href="http://g0dup05u.ecs.nasa.gov/cgi-bin/ceopAIRX2RET?service=WCS&amp;version=1.0.0&amp;request=GetCoverage&amp;coverage=H2OMMRStd&amp;crs=WGS84&amp;bbox=-107.375000,51.625000,-102.625000,56.375000&amp;format=netCDF&amp;TIME=2002-10-03&amp;resx=0.25&amp;resy=0.25&amp;interpolationMethod=Nearest%20neighbor">http://g0dup05u.ecs.nasa.gov/cgi-bin/ceopAIRX2RET?service=WCS&amp;version=1.0.0&amp;request=GetCoverage&amp;coverage=H2OMMRStd&amp;crs=WGS84&amp;bbox=-107.375000,51.625000,-102.625000,56.375000&amp;format=netCDF&amp;TIME=2002-10-03&amp;resx=0.25&amp;resy=0.25&amp;interpolationMethod=Nearest%20neighbor</a>
</dd>
</dl>
<h4><span class="mw-headline" id="Example_3"><span class="mw-headline-number">4.1.3</span> Example 3</span></h4>
<dl>
<dt>source string</dt>
<dd>      foobar
</dd>
</dl>
<dl>
<dt>stringToHex()</dt>
<dd>        666f6f626172
</dd>
</dl>
<dl>
<dt>hexToString(stringToHex()</dt>
<dd> foobar
</dd>
</dl>




</div>
				<!-- end content -->
				<div class="visualClear"></div>
	</div>
</div></div>
</body></html>